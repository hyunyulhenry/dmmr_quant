<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>R 기초 배우기</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">R 기초 배우기</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>이번 장에서는 R과 R 스튜디오의 설치, R 스튜디오의 화면 구성과 간단한 사용법에 대해서 배우도록 하겠습니다. 본 장은 R의 기초 중에서도 핵심만을 추린 것으로써, 기초에 대해 세세하게 다루지는 않습니다. 좀 더 탄탄한 기본기를 배우고 싶으신 분은 시중에 나와있는 훌륭한 R 기본 서적을 추가로 보실 것을 추천드립니다.</p>
<section id="r과-r-스튜디오-설치하기" class="level2">
<h2 class="anchored" data-anchor-id="r과-r-스튜디오-설치하기">R과 R 스튜디오 설치하기</h2>
<section id="r-설치하기" class="level3">
<h3 class="anchored" data-anchor-id="r-설치하기">R 설치하기</h3>
<p>먼저 R 프로젝트 공식 사이트인 <a href="https://cran.r-project.org/" class="uri">https://cran.r-project.org/</a> 에 접속하여 본인의 OS에 맞는 설치 파일을 다운로드 합니다.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/r_basic/rbasic_cran.png" class="lightbox" title="CRAN 사이트" data-gallery="quarto-lightbox-gallery-1"><img src="images/r_basic/rbasic_cran.png" class="img-fluid figure-img"></a></p>
<p></p><figcaption class="figure-caption">CRAN 사이트</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>가장 상단의 [base]를 선택합니다.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/r_basic/rbasic_cran2.png" class="lightbox" title="R 다운로드 화면" data-gallery="quarto-lightbox-gallery-2"><img src="images/r_basic/rbasic_cran2.png" class="img-fluid figure-img"></a></p>
<p></p><figcaption class="figure-caption">R 다운로드 화면</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>[Download R x.x.x for Windows] 항목을 클릭하면 설치 파일이 다운로드 됩니다. 다운로드 받은 파일을 실행해 설치를 하며, 옵션은 수정하지 않아도 됩니다.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/r_basic/rbasic_cran3.png" class="lightbox" title="R 설치파일 다운로드" data-gallery="quarto-lightbox-gallery-3"><img src="images/r_basic/rbasic_cran3.png" class="img-fluid figure-img"></a></p>
<p></p><figcaption class="figure-caption">R 설치파일 다운로드</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="r-스튜디오-설치하기" class="level3">
<h3 class="anchored" data-anchor-id="r-스튜디오-설치하기">R 스튜디오 설치하기</h3>
<p>위에서 설치한 R GUI를 그대로 쓰는 사용자는 거의 없습니다. 대부분의 경우 R을 사용하기 편리하게 만들어주는 IDE 소프트웨어인 R 스튜디오를 사용하므로, 해당 프로그램을 설치하도록 합니다. R 스튜디오를 사용하려면 R이 먼저 설치되어 있어야 하며, R과 마찬가지로 무료로 사용할 수 있습니다. 먼저 아래 사이트에 접속합니다.</p>
<ul>
<li>https://posit.co/download/rstudio-desktop/</li>
</ul>
<p>하단의 [All Installers] 항목에서 본인의 OS에 해당하는 파일을 다운로드 받아 설치합니다.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/image-982575800.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="images/image-982575800.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
<p>윈도우 사용자의 경우 간혹 R 스튜디오를 실행하는데 있어 오류가 발생할 수 있습니다.</p>
<ol type="1">
<li>R 스튜디오가 관리자 권한으로 실행되지 않으면 오류가 발생할 수 있으며, 이 경우 아래와 같은 방법으로 해결이 가능합니다.</li>
</ol>
<ul>
<li>R 스튜디오 바로가기 아이콘을 마우스 우클릭으로 연 후, [속성] → [호환성]을 클릭합니다.</li>
<li>[관리자 권한으로 이 프로그램 실행]에 체크한 후 [확인]을 누릅니다.</li>
</ul>
<p><br> 2. 윈도우 사용자 계정이 한글인 경우 기존 사용자 계정을 영문으로 변경하거나, 영문으로 된 사용자 계정을 새로 추가합니다.</p>
</section>
</section>
<section id="r-스튜디오-화면-구성" class="level2">
<h2 class="anchored" data-anchor-id="r-스튜디오-화면-구성">R 스튜디오 화면 구성</h2>
<p>처음으로 R 스튜디오를 실행하면 다음과 같은 화면으로 구성되어 있습니다. 이 중 소스 창을 열기 위해 네모 2개가 겹쳐 있는 모양(<a href="images/r_basic/rbasic_rstudio_small.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="images/r_basic/rbasic_rstudio_small.png" class="img-fluid"></a>)의 버튼을 클릭합니다.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/r_basic/rbasic_rstudio_base1.png" class="lightbox" title="R 스튜디오 화면구성" data-gallery="quarto-lightbox-gallery-6"><img src="images/r_basic/rbasic_rstudio_base1.png" class="img-fluid figure-img"></a></p>
<p></p><figcaption class="figure-caption">R 스튜디오 화면구성</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>소스 창이 활성화되면 총 4개의 창으로 화면이 구성되며, 각 창의 크기는 경계선 부분을 드래그하여 조절할 수 있습니다.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/r_basic/rbasic_rstudio_base2.png" class="lightbox" title="R 스튜디오 화면구성 (2)" data-gallery="quarto-lightbox-gallery-7"><img src="images/r_basic/rbasic_rstudio_base2.png" class="img-fluid figure-img"></a></p>
<p></p><figcaption class="figure-caption">R 스튜디오 화면구성 (2)</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><strong>1. 콘솔 창</strong></p>
<p>좌측 하단에 있는 콘솔 창은 코드를 입력하고 결과물을 출력하는 곳입니다.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/r_basic/rbasic_rstudio_console.png" class="lightbox" title="R 스튜디오 콘솔 창" data-gallery="quarto-lightbox-gallery-8"><img src="images/r_basic/rbasic_rstudio_console.png" class="img-fluid figure-img"></a></p>
<p></p><figcaption class="figure-caption">R 스튜디오 콘솔 창</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>콘솔 창의 &gt; 기호 뒤에 <strong>1+1</strong>을 입력하면 그 결과값인 <strong>2</strong>가 출력됩니다.</p>
<p>이 외에도 [Terminal] 탭에서는 시스템 쉘을 이용해 운영 체제를 조작할 수 있습니다.</p>
<p><strong>2. 소스 창</strong></p>
<p>좌측 상단에 있는 소스 창은 코드를 기록할 수 있는 공간이며, 이를 저장한 파일을 스크립트라고 합니다. 콘솔 창과는 다르게 코드를 입력하여도 바로 실행이 되지 않으며, 엔터를 누르면 행이 바뀝니다. 실행하고자 하는 코드가 있는 행을 선택한 후, [Ctrl + Enter]키를 누르면 해당 코드가 실행됩니다.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/r_basic/rbasic_rstudio_console2.png" class="lightbox" title="R 스튜디오 소스 창의 실행" data-gallery="quarto-lightbox-gallery-9"><img src="images/r_basic/rbasic_rstudio_console2.png" class="img-fluid figure-img"></a></p>
<p></p><figcaption class="figure-caption">R 스튜디오 소스 창의 실행</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>3*7이란 코드가 있는 곳에 커서를 둔 후 [Ctrl + Enter]키를 누르면 해당 코드가 콘솔 창에서 실행됩니다. 만일 여러줄의 명령어를 한번에 실행하고 할 경우, 원하는 부분의 코드를 마우스로 드래그하여 선택한 후 [Ctrl + Enter]키를 누르면 코드가 순차적으로 콘솔 창에 입력되면서 실행됩니다.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/r_basic/rbasic_rstudio_console3.png" class="lightbox" title="R 스튜디오 소스 저장하기" data-gallery="quarto-lightbox-gallery-10"><img src="images/r_basic/rbasic_rstudio_console3.png" class="img-fluid figure-img"></a></p>
<p></p><figcaption class="figure-caption">R 스튜디오 소스 저장하기</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>위에서 작성한 코드를 저장해보도록 하겠습니다. 저장 버튼(<a href="images/r_basic/rbasic_rstudio_save.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="images/r_basic/rbasic_rstudio_save.png" class="img-fluid"></a>)을 클릭한 후 원하는 폴더 및 파일 이름을 입력 한 후 [Save] 버튼을 누릅니다.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/r_basic/rbasic_rstudio_console4.png" class="lightbox" title="R 스튜디오 소스 저장하기 (2)" data-gallery="quarto-lightbox-gallery-12"><img src="images/r_basic/rbasic_rstudio_console4.png" class="img-fluid figure-img"></a></p>
<p></p><figcaption class="figure-caption">R 스튜디오 소스 저장하기 (2)</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Untitled1로 되어 있던 스크립트의 이름이 저장한 이름으로 바뀌며, 스크립트가 저장되어 있는 것이 확인됩니다. 이처럼 코딩을 한 후 스크립트를 저장할 경우, 나중에 해당 내역을 그대로 불러올 수 있습니다.</p>
<p><strong>3. 환경 창</strong></p>
<p>우측 상단에 있는 환경 창은 생성된 데이터를 보여주는 화면입니다.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/r_basic/rbasic_rstudio_env.png" class="lightbox" title="R 스튜디오 환경 창" data-gallery="quarto-lightbox-gallery-13"><img src="images/r_basic/rbasic_rstudio_env.png" class="img-fluid figure-img"></a></p>
<p></p><figcaption class="figure-caption">R 스튜디오 환경 창</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>스크립트 창에서 <strong>a = 1</strong>을 입력하면, 환경 창의 Values 목록에 a가 생기며 그 값은 1로 표시됩니다.</p>
<p>이 외에도 환경 창의 [History] 탭은 이제까지 실행했던 코드의 내역을 볼 수 있으며, [Connections] 탭은 SQL이나 Spark 등 데이터베이스와의 연결을 도와줍니다.</p>
<p><strong>4. 파일 창</strong></p>
<p>우측 하단에 있는 파일 창은 윈도우의 파일 탐색기와 비슷한 역할을 하며, 워킹 디렉터리 내의 파일을 보여줍니다. 이 외에도 [Plots] 탭은 그래프를 보여주며 [Packages] 탭은 설치된 패키지의 목록을 보여줍니다. [Help] 탭은 도움말을 보여주며, [Viewer] 탭은 분석 결과를 HTML 등 웹 문서로 출력한 모습을 보여줍니다.</p>
</section>
<section id="r-스튜디오-설정하기" class="level2">
<h2 class="anchored" data-anchor-id="r-스튜디오-설정하기">R 스튜디오 설정하기</h2>
<p>R 스튜디오는 기본적으로 흰색 바탕에 검은색 글씨로 설정되어 있습니다. 그러나 흰 화면에서 작업을 하게 되면 눈이 쉽게 피로해지며, 시력에도 좋지 않습니다. 이를 방지하기 위해 어두운 화면으로 설정을 변경해주는 것이 좋습니다.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/r_basic/rbasic_rstudio_dark.png" class="lightbox" title="R 스튜디오의 테마 선택" data-gallery="quarto-lightbox-gallery-14"><img src="images/r_basic/rbasic_rstudio_dark.png" class="img-fluid figure-img"></a></p>
<p></p><figcaption class="figure-caption">R 스튜디오의 테마 선택</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>상단 탭에서 [Tools] → [Global Options]를 선택한 후, Options의 [Appearance] 탭의 [Editor theme]을 통해 각종 테마를 적용할 수 있습니다. 이 중 본인의 마음에 드는 테마를 선택한 후, [OK] 버튼을 누릅니다.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/r_basic/rbasic_rstudio_dark2.png" class="lightbox" title="R 스튜디오의 다크모드 적용" data-gallery="quarto-lightbox-gallery-15"><img src="images/r_basic/rbasic_rstudio_dark2.png" class="img-fluid figure-img"></a></p>
<p></p><figcaption class="figure-caption">R 스튜디오의 다크모드 적용</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>화면의 배경이 어두워져 눈이 한결 편해졌습니다.</p>
</section>
<section id="프로젝트-만들기" class="level2">
<h2 class="anchored" data-anchor-id="프로젝트-만들기">프로젝트 만들기</h2>
<p>R 스튜디오에서 코딩을 하기 전에 프로젝트(Project)를 만들면 하나의 프로젝트에 사용되는 소스 코드, 이미지, 문서 등의 파일을 폴더별로 관리하여 효율적으로 관리할 수 있습니다.</p>
<p>먼저 R 스튜디오 상단의 육각형 모양 버튼(<a href="images/r_basic/rbasic_rstudio_project.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img src="images/r_basic/rbasic_rstudio_project.png" class="img-fluid"></a>)을 클릭하거나 [File → New Project]를 클릭합니다.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/r_basic/rbasic_project.png" class="lightbox" title="프로젝트 생성" data-gallery="quarto-lightbox-gallery-17"><img src="images/r_basic/rbasic_project.png" class="img-fluid figure-img"></a></p>
<p></p><figcaption class="figure-caption">프로젝트 생성</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>[Create Project] 화면에서 가장 상단의 [New Directory]를 클릭합니다. 참고로 Existing Directory는 기존 폴더에 새로운 프로젝트를 만들때, Version Control은 깃허브 등의 버전 관리 시스템을 이용할 때 사용됩니다.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/r_basic/rbasic_newproject.png" class="lightbox" title="새 프로젝트 생성" data-gallery="quarto-lightbox-gallery-18"><img src="images/r_basic/rbasic_newproject.png" class="img-fluid figure-img"></a></p>
<p></p><figcaption class="figure-caption">새 프로젝트 생성</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>[Project Type]에서 가장 상단의 [New Project]를 클릭합니다.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/r_basic/rbasic_newproject2.png" class="lightbox" title="새 프로젝트 생성 (2)" data-gallery="quarto-lightbox-gallery-19"><img src="images/r_basic/rbasic_newproject2.png" class="img-fluid figure-img"></a></p>
<p></p><figcaption class="figure-caption">새 프로젝트 생성 (2)</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>[Create New Project] 창에서 [Directory name] 항목에 새로 만들 프로젝트 이름을 입력합니다. [Create project as subdirectory of] 항목에는 프로젝트 폴더를 만들 위치를 선택하며, [Browse]를 클릭해 원하는 위치를 선택합니다. 그 후 하단의 [Creage Project]를 클릭합니다.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/r_basic/rbasic_newproject3.png" class="lightbox" title="새 프로젝트 생성 (3)" data-gallery="quarto-lightbox-gallery-20"><img src="images/r_basic/rbasic_newproject3.png" class="img-fluid figure-img"></a></p>
<p></p><figcaption class="figure-caption">새 프로젝트 생성 (3)</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>R 스튜디오가 재시작되면 우측 상단 부분이 프로젝트 이름으로 바뀌며, 파일 창의 윗부분도 프로젝트 폴더의 위치로 바뀝니다. 또한 폴더 내에 fin_ds.Rpoj 라는 파일이 생성됩니다. 스크립트 및 각종 파일들을 해당 프로젝트 폴더에 저장하여, 효율적으로 각종 작업을 관리할 수 있습니다.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/r_basic/rbasic_newproject4.png" class="lightbox" title="새 프로젝트 생성 (4)" data-gallery="quarto-lightbox-gallery-21"><img src="images/r_basic/rbasic_newproject4.png" class="img-fluid figure-img"></a></p>
<p></p><figcaption class="figure-caption">새 프로젝트 생성 (4)</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>프로젝트 이름과 폴더 경로에 한글이 들어가면 오류가 발생할 수 있으니, 영문으로 입력하는 것이 좋습니다.</p>
</section>
<section id="데이터-타입별-다루기" class="level2">
<h2 class="anchored" data-anchor-id="데이터-타입별-다루기">데이터 타입별 다루기</h2>
<p>R과 R 스튜디오 설치가 끝났으면 본격적으로 R의 기본적인 사용법에 대해 배워보겠으며, 먼저 데이터의 타입별로 다루는 법부터 시작하겠습니다.</p>
<p>R 뿐만 아니라 각종 프로그래밍에는 여러가지 데이터 타입이 있으며, 이를 다루는 방법은 각각 다릅니다. 예를 들어 같은 ’3’도 숫자 3인지 문자 3인지에 따라 다루는 방법이 다릅니다. 따라서 데이터 타입의 종류와 이들을 어떻게 다루어야 하는지를 아는 것이 프로그래밍의 기초라고 할 수 있습니다.</p>
<section id="숫자-형태" class="level3">
<h3 class="anchored" data-anchor-id="숫자-형태">숫자 형태</h3>
<p>R에서 숫자(Numbers) 형태는 크게 integer와 double로 나눌 수 있습니다. 이 중 integer는 정수를 의미하며, double은 부동소수점 실수를 의미합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>dbl_var <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">2.5</span>, <span class="fl">4.5</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dbl_var)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.0 2.5 4.5</code></pre>
</div>
</div>
<p>위와 같이 입력하면 double, 즉 소수점 형태의 숫자가 만들어 집니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>int_var <span class="ot">=</span> <span class="fu">c</span>(1L, 6L, 5L)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(int_var)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 6 5</code></pre>
</div>
</div>
<p>만일 숫자 뒤에 <strong>L</strong>을 붙이면, integer(정수) 형태의 숫자가 만들어 집니다.</p>
<p>double 형태를 integer 형태로 바꾸려면 할 경우, <code>as.integer()</code> 함수를 사용해 쉽게 변경할 수 있습니다. 이처럼 R에서는 <code>as.*()</code> 함수의 형태로 각 데이터의 형태를 바꿀 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.integer</span>(dbl_var)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 4</code></pre>
</div>
</div>
<p>[1.0 2.5 4.5] 이던 dbl_var 값이 <code>as.integer()</code> 함수를 통해 소수점이 사라지고 정수 형태인 [1 2 4]로 변경되었습니다.</p>
<section id="숫자-생성하기" class="level4">
<h4 class="anchored" data-anchor-id="숫자-생성하기">숫자 생성하기</h4>
<p>R에서는 콜론(:)과 <code>c()</code> 함수를 통해 순서가 있는 숫자 벡터를 생성할 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
</div>
</div>
<p><strong>시작숫자:끝숫자</strong>의 형태로 입력하여 1에서 10까지 숫자가 생성됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1  5 10</code></pre>
</div>
</div>
<p><code>c()</code> 함수 내부에 각각의 숫자를 입력할 경우, 이로 구성된 숫자 벡터가 생성됩니다.</p>
<p><code>seq()</code> 함수를 이용할 경우 더욱 다양하게 숫자 벡터를 생성할 수 있습니다. seq는 Sequence 즉 ’순서’의 약어입니다. 이처럼 R이나 여타 프로그래밍에서는 함수의 이름을 통해 대략적인 기능을 추론할 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> <span class="dv">21</span>, <span class="at">by =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1  3  5  7  9 11 13 15 17 19 21</code></pre>
</div>
</div>
<p><code>seq()</code> 함수 내부에 from에는 시작 숫자, to에는 종료 숫자, by에는 간격을 입력합니다. 즉 1에서 21까지 2 단위로 숫자가 생성됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">21</span>, <span class="at">length.out =</span> <span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  0.0  1.5  3.0  4.5  6.0  7.5  9.0 10.5 12.0 13.5 15.0 16.5 18.0 19.5 21.0</code></pre>
</div>
</div>
<p>만일 입력값에 <strong>by</strong> 대신 <strong>length.out</strong>을 쓸 경우 from에서 to 까지 동일한 증가폭으로 length.out 만큼의 숫자를 생성하며, 해당 예제에서는 총 15개의 숫자가 만들어집니다.</p>
<p><code>rep()</code> 함수 역시 숫자를 생성해주는 함수입니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">times =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 4 1 2 3 4</code></pre>
</div>
</div>
<p>rep는 Replicate 즉 ’복제하다’의 약어 입니다. 해당 함수 내에 <strong>times</strong>라는 입력값을 추가해줄 경우, 해당 숫자만큼 반복되어 벡터가 생성됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">each =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 1 2 2 3 3 4 4</code></pre>
</div>
</div>
<p>만일 <strong>each</strong>라는 입력값을 추가할 경우, 각각의 숫자를 n번 반복하여 벡터가 생성됩니다.</p>
</section>
<section id="올림-내림-반올림" class="level4">
<h4 class="anchored" data-anchor-id="올림-내림-반올림">올림, 내림, 반올림</h4>
<p>함수를 통해 간단하게 숫자의 올림, 내림, 반올림을 할 수도 있습니다. 먼저 다음과 같이 숫자를 입력합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.35</span>, <span class="fl">1.7</span>, <span class="fl">2.053</span>, <span class="fl">2.4</span>, <span class="fl">2.758</span>, <span class="fl">3.1</span>, <span class="fl">3.45</span>,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>      <span class="fl">3.8</span>, <span class="fl">4.15</span>, <span class="fl">4.5</span>, <span class="fl">4.855</span>, <span class="fl">5.2</span>, <span class="fl">5.55</span>, <span class="fl">5.9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 2 2 2 3 3 3 4 4 4 5 5 6 6</code></pre>
</div>
</div>
<p><code>round()</code> 함수는 가장 가까운 정수로 반올림을 합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(x, <span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1.00 1.35 1.70 2.05 2.40 2.76 3.10 3.45 3.80 4.15 4.50 4.86 5.20 5.55 5.90</code></pre>
</div>
</div>
<p>함수 내부에 <strong>digits</strong> 입력값을 추가해 줄 경우, 해당 자리수 만큼 반올림을 합니다. 위 예제에서는 소수 둘째자리 만큼 반올림을 하였습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ceiling</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 2 2 3 3 3 4 4 4 5 5 5 6 6 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">floor</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 1 2 2 2 3 3 3 4 4 4 5 5 5</code></pre>
</div>
</div>
<p><code>ceiling()</code> 함수는 올림을, <code>floor()</code> 함수는 내림을 실행합니다.</p>
</section>
</section>
<section id="문자열-형태" class="level3">
<h3 class="anchored" data-anchor-id="문자열-형태">문자열 형태</h3>
<p>일반적인 글자 혹은 텍스트를 문자열(Character Strings)이라고 합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="st">'learning to create'</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="st">'character strings'</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(a, b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "learning to create character strings"</code></pre>
</div>
</div>
<p>먼저 a와 b 변수에 각각의 문자를 입력한 후, R의 기본함수인 <code>paste()</code> 함수를 이용해 두 문자를 붙일 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.141593</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">'pi is'</span>, pi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "pi is 3.14159265358979"</code></pre>
</div>
</div>
<p>원주율을 의미하는 pi는 원래 3.14159 라는 숫자가 입력되어 있습니다. 그러나 <code>paste()</code> 함수를 통해 문자열과 숫자를 합칠 경우, 그 결과값은 문자열이 됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">'I'</span>, <span class="st">'love'</span>, <span class="st">'R'</span>, <span class="at">sep =</span> <span class="st">','</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "I,love,R"</code></pre>
</div>
</div>
<p><code>paste()</code> 함수 내부에 sep 인자를 추가할 경우, 각 단어를 구분하는 문자를 입력할 수 있습니다. 기존에는 각 문자가 공백을 기준으로 합쳐졌다면, 이번에는 콤마(,)를 기준으로 합쳐졌습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">'I'</span>, <span class="st">'love'</span>, <span class="st">'R'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "IloveR"</code></pre>
</div>
</div>
<p><code>paste0()</code> 함수는 구분 문자가 없이 결합됩니다.</p>
<section id="stringr-패키지를-이용한-문자열-다루기" class="level4">
<h4 class="anchored" data-anchor-id="stringr-패키지를-이용한-문자열-다루기"><code>stringr</code> 패키지를 이용한 문자열 다루기</h4>
<p>R의 기본함수를 이용하여도 문자열을 다룰 수 있지만, <code>stringr</code> 패키지를 이용할 경우 더욱 다양한 작업을 수행할 수 있습니다. 패키지를 설치하는 방법은 다음과 같습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">'패키지이름'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>stringr 패키지를 설치한 후 다음과 같이 입력합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str_c</span>(<span class="st">'Learning'</span>, <span class="st">'to'</span>, <span class="st">'use'</span>, <span class="st">'the'</span>, <span class="st">'stringr'</span>, <span class="st">'package'</span>, <span class="at">sep =</span> <span class="st">' '</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Learning to use the stringr package"</code></pre>
</div>
</div>
<p><code>str_c()</code> 함수는 <code>paste()</code> 함수와 기능이 동일하며, sep 인자를 통해 구분자를 추가할 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>text <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'Learning'</span>, <span class="st">'to'</span>, <span class="cn">NA</span>, <span class="st">'use'</span>, <span class="st">'the'</span>, <span class="cn">NA</span>, <span class="st">'stringr'</span>, <span class="st">'package'</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_length</span>(text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  8  2 NA  3  3 NA  7  7</code></pre>
</div>
</div>
<p><code>str_length()</code> 함수는 문자열 각각의 텍스트 갯수를 세줍니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="st">'Learning to use the stringr package'</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str_sub</span>(x, <span class="at">start =</span> <span class="dv">1</span>, <span class="at">end =</span> <span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Learning to use"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_sub</span>(x, <span class="at">start =</span> <span class="sc">-</span><span class="dv">7</span>, <span class="at">end =</span> <span class="sc">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "package"</code></pre>
</div>
</div>
<p><code>str_sub()</code> 함수는 start부터 end까지의 문자를 출력합니다. 만일 start 혹은 end에 음수를 입력하면, 문장의 뒤에서부터 start/end 지점이 계산됩니다. 즉, start와 end에 각각 -7와 -1을 입력하면 끝에서부터 일곱번째와 첫번째 지점이 시작점과 끝점이 됩니다.</p>
<p>텍스트 데이터를 다룰때는 빈 공백이 따라오는 경우가 많으며, 이는 대부분 제거해주어야 할 대상입니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>text <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'Text '</span>, <span class="st">' with'</span>, <span class="st">' whitespace '</span>, <span class="st">' on'</span>, <span class="st">'both '</span>, <span class="st">'sides '</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Text "        " with"        " whitespace " " on"          "both "       
[6] "sides "      </code></pre>
</div>
</div>
<p>각 단어를 자세히 살펴보면 좌/우 혹은 양쪽에 공백이 있습니다. 이를 제거하도록 하겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_trim</span>(text, <span class="at">side =</span> <span class="st">'left'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Text "       "with"        "whitespace " "on"          "both "      
[6] "sides "     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_trim</span>(text, <span class="at">side =</span> <span class="st">'right'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Text"        " with"       " whitespace" " on"         "both"       
[6] "sides"      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_trim</span>(text, <span class="at">side =</span> <span class="st">'both'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Text"       "with"       "whitespace" "on"         "both"      
[6] "sides"     </code></pre>
</div>
</div>
<p><code>str_trim()</code> 함수는 공백을 제거해주는 기능을 합니다. side 인자에 <strong>left</strong>를 입력할 경우 각 텍스트 왼쪽의 공백을, <strong>right</strong>를 입력할 경우 오른쪽의 공백을, <strong>both</strong>를 입력할 경우 양쪽의 공백을 제거해줍니다.</p>
<p>마지막으로 원하는 자리수를 채우기 위해 문자열에 공백 혹은 특정 문자를 입력할 수도 있으며, <code>str_pad()</code> 함수를 통해 손쉽게 작업을 할 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_pad</span>(<span class="st">'beer'</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">side =</span> <span class="st">'left'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "      beer"</code></pre>
</div>
</div>
<p>width에 해당하는 10자리를 맞추기 위해 side의 입력값인 좌측에 공백이 추가되었습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_pad</span>(<span class="st">'beer'</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">side =</span> <span class="st">'left'</span>, <span class="at">pad =</span> <span class="st">'!'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "!!!!!!beer"</code></pre>
</div>
</div>
<p>pad 인자를 추가할 경우, 공백이 아닌 입력한 문자가 추가됩니다</p>
<p>아래 페이지에는 <code>stringr</code> 패키지의 자세한 사용법이 나와 있습니다.</p>
<ul>
<li><a href="https://stringr.tidyverse.org/" class="uri">https://stringr.tidyverse.org/</a></li>
</ul>
</section>
</section>
<section id="날짜-형태" class="level3">
<h3 class="anchored" data-anchor-id="날짜-형태">날짜 형태</h3>
<p>시계열 작업을 위해서는 날짜(Date), 혹은 시간(Datetime) 형태를 다루어야 합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.timezone</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Asia/Seoul"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.Date</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2023-01-19"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.time</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2023-01-19 11:46:42 KST"</code></pre>
</div>
</div>
<p><code>Sys.timezone()</code> 함수는 현재 타임존을 출력합니다. <code>Sys.Date()</code> 함수는 현재 날짜를, <code>Sys.time()</code> 함수는 날짜와 시간을 출력합니다.</p>
<p>’2018-12-31’과 같이 사용자가 보기에는 날짜 형태이지만 문자열 형태로 데이터가 들어오는 경우, 이를 날짜 형태로 변경해야 할 경우가 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'2021-07-01'</span>, <span class="st">'2021-08-01'</span>, <span class="st">'2021-09-01'</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>x_date <span class="ot">=</span> <span class="fu">as.Date</span>(x)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(x_date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Date[1:3], format: "2021-07-01" "2021-08-01" "2021-09-01"</code></pre>
</div>
</div>
<p><code>as.Date()</code> 함수를 이용하면 문자열을 손쉽게 날짜 형태로 변경할 수 있습니다. <code>str()</code> 함수는 데이터의 형태를 확인하는 함수로써, Date 형태임이 확인됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'07/01/2015'</span>, <span class="st">'08/01/2015'</span>, <span class="st">'09/01/2015'</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="fu">as.Date</span>(y, <span class="at">format =</span> <span class="st">'%m/%d/%Y'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2015-07-01" "2015-08-01" "2015-09-01"</code></pre>
</div>
</div>
<p>YYYY-MM-DD 형태가 아닌 다른 형태(MM/DD/YYYY)로 입력된 경우, format을 직접 입력하여 Date 형태로 변경할 수 있습니다.</p>
<p>YYYY는 연, MM은 월, DD는 일을 나타냅니다.</p>
<section id="lubridate-패키지를-이용한-날짜-다루기" class="level4">
<h4 class="anchored" data-anchor-id="lubridate-패키지를-이용한-날짜-다루기"><code>lubridate</code> 패키지를 이용한 날짜 다루기</h4>
<p><code>lubridate</code> 패키지를 이용할 경우 날짜 형태와 관련된 다양한 작업을 수행할 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: timechange</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'lubridate'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    date, intersect, setdiff, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'2021-07-01'</span>, <span class="st">'2021-08-01'</span>, <span class="st">'2021-09-01'</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'07/01/2015'</span>, <span class="st">'08/01/2015'</span>, <span class="st">'09/01/2015'</span>)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ymd</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2021-07-01" "2021-08-01" "2021-09-01"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mdy</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2015-07-01" "2015-08-01" "2015-09-01"</code></pre>
</div>
</div>
<p><code>lubridate</code> 패키지를 이용할 경우 YYYY-MM-DD 형태는 <code>ymd()</code>, MM-DD-YYYY 형태는 <code>mdy()</code> 함수를 사용해 손쉽게 Date 형태로 변경할 수 있습니다. 이 외에도 <code>lubridate</code>에는 Date 형태로 변경하기 위한 다양한 함수가 존재합니다.</p>
<div class="cell">
<div class="cell-output-display">

<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<caption>lubridate 패키지의 Date 형태 변경 함수</caption>
 <thead>
  <tr>
   <th style="text-align:center;"> 순서 </th>
   <th style="text-align:center;"> 함수 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:center;"> 연, 월, 일 </td>
   <td style="text-align:center;"> ymd() </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 연, 일, 월 </td>
   <td style="text-align:center;"> ydm() </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 월, 일, 연 </td>
   <td style="text-align:center;"> mdy() </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 일, 월, 연 </td>
   <td style="text-align:center;"> dmy() </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 시, 분 </td>
   <td style="text-align:center;"> hm() </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 시, 분, 초 </td>
   <td style="text-align:center;"> hms() </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 연, 월, 일, 시, 분, 초 </td>
   <td style="text-align:center;"> ymd_hms() </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p><code>lubridate</code> 패키지에는 날짜 관련 정보를 추출할 수 있는 다양한 함수가 존재합니다.</p>
<div class="cell">
<div class="cell-output-display">

<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<caption>lubridate 패키지의 날짜 관련 정보 추출 함수</caption>
 <thead>
  <tr>
   <th style="text-align:center;"> 정보 </th>
   <th style="text-align:center;"> 함수 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:center;"> 연 </td>
   <td style="text-align:center;"> year() </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 월 </td>
   <td style="text-align:center;"> month() </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 주 </td>
   <td style="text-align:center;"> week() </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 연도 내 일수 </td>
   <td style="text-align:center;"> yday() </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 월 내 일수 </td>
   <td style="text-align:center;"> mday() </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 주 내 일수 </td>
   <td style="text-align:center;"> wday() </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 시 </td>
   <td style="text-align:center;"> hour() </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 분 </td>
   <td style="text-align:center;"> minute() </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 초 </td>
   <td style="text-align:center;"> second() </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 타임존 </td>
   <td style="text-align:center;"> tz() </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'2021-07-01'</span>, <span class="st">'2021-08-01'</span>, <span class="st">'2021-09-01'</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="fu">year</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2021 2021 2021</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">month</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7 8 9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">week</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 26 31 35</code></pre>
</div>
</div>
<p><code>year()</code>, <code>month()</code>, <code>week()</code> 함수를 통해 년도, 월, 주 정보를 확인할 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="st">'2021-09-15'</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="fu">yday</span>(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 258</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mday</span>(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wday</span>(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
<p><code>yday()</code>, <code>mday()</code>, <code>wday()</code> 함수는 각각 해당 년도에서 몇번째 일인지, 해당 월에서 몇번째 일인지, 해당 주에서 몇번째 일인지를 계산합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">ymd</span>(<span class="st">'2021-07-01'</span>, <span class="st">'2021-08-01'</span>, <span class="st">'2021-09-01'</span>) </span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>x <span class="sc">+</span> <span class="fu">years</span>(<span class="dv">1</span>) <span class="sc">-</span> <span class="fu">days</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">9</span>, <span class="dv">21</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2022-06-29" "2022-07-23" "2022-08-11"</code></pre>
</div>
</div>
<p>날짜에서 연과 월, 일자를 더하거나 빼는 계산 역시 가능합니다. 먼저 <code>year()</code> 함수를 통해 1년씩을 더 하였으며, <code>days()</code> 함수를 통해 각각의 일자 만큼을 뺍니다.</p>
</section>
<section id="날짜-순서-생성하기" class="level4">
<h4 class="anchored" data-anchor-id="날짜-순서-생성하기">날짜 순서 생성하기</h4>
<p>숫자와 마찬가지로 <code>seq()</code> 함수를 이용할 경우 날짜 벡터를 생성할 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span>(<span class="fu">ymd</span>(<span class="st">'2015-01-01'</span>), <span class="fu">ymd</span>(<span class="st">'2021-01-01'</span>), <span class="at">by =</span><span class="st">'years'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2015-01-01" "2016-01-01" "2017-01-01" "2018-01-01" "2019-01-01"
[6] "2020-01-01" "2021-01-01"</code></pre>
</div>
</div>
<p>2015년 1월 1일부터 2021년 1월 1일까지 1년을 기준으로 벡터가 생성됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span>(<span class="fu">ymd</span>(<span class="st">'2021-09-01'</span>), <span class="fu">ymd</span>(<span class="st">'2021-09-30'</span>), <span class="at">by =</span><span class="st">'2 days'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "2021-09-01" "2021-09-03" "2021-09-05" "2021-09-07" "2021-09-09"
 [6] "2021-09-11" "2021-09-13" "2021-09-15" "2021-09-17" "2021-09-19"
[11] "2021-09-21" "2021-09-23" "2021-09-25" "2021-09-27" "2021-09-29"</code></pre>
</div>
</div>
<p>지정한 일수인 2일 단위로 날짜 벡터를 생성할 수도 있습니다. 이 외에도 by 인자를 통해 원하는 기간 단위의 벡터를 생성할 수 있습니다.</p>
<p>아래 페이지에는 lubridate 패키지의 자세한 사용법이 나와 있습니다.</p>
<ul>
<li><a href="https://lubridate.tidyverse.org/" class="uri">https://lubridate.tidyverse.org/</a></li>
</ul>
</section>
</section>
</section>
<section id="데이터-구조-다루기" class="level2">
<h2 class="anchored" data-anchor-id="데이터-구조-다루기">데이터 구조 다루기</h2>
<p>R에서 자주 사용되는 데이터구조는 벡터(Vector), 리스트(List), 데이터프레임(Dataframe) 입니다.</p>
<section id="벡터-다루기" class="level3">
<h3 class="anchored" data-anchor-id="벡터-다루기">벡터 다루기</h3>
<p>벡터는 R의 가장 기본적인 데이터 구조로써 integer, double, logical, character로 이루어져 있습니다. 벡터를 만드는 방법에 대해서는 앞서 다루었습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>vec_integer <span class="ot">=</span> <span class="dv">8</span><span class="sc">:</span><span class="dv">17</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>vec_integer</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  8  9 10 11 12 13 14 15 16 17</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>vec_double <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.6</span>, <span class="fl">0.2</span>)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>vec_double</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5 0.6 0.2</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>vec_char <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>vec_char</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "a" "b" "c"</code></pre>
</div>
</div>
<p>integer의 경우 start:end 형태를 통해서, 그 외에는 <code>c()</code> 함수를 통해 벡터를 만들 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "a" "b" "c" "1" "2" "3"</code></pre>
</div>
</div>
<p>숫자와 문자가 같이 벡터로 묶일 경우, 숫자는 모두 문자 형태로 변경됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 1 0</code></pre>
</div>
</div>
<p>TRUE와 FALSE는 참 혹은 거짓을 나타내는 논리값(logical) 입니다. 숫자와 논리값이 같이 묶일 경우 TRUE는 1, FALSE는 0으로 치환된 후 숫자 형태로 변경됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "a"     "b"     "c"     "TRUE"  "FALSE"</code></pre>
</div>
</div>
<p>문자와 논리값이 같이 묶일 경우 모두 문자 형태로 변경됩니다. 이처럼 문자와 다른 형태가 묶일 경우엔 모든 데이터가 문자로 변경됩니다.</p>
<p>이번에는 기존의 벡터에 새로운 값을 추가해보겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>v1 <span class="ot">=</span> <span class="dv">8</span><span class="sc">:</span><span class="dv">17</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(v1, <span class="dv">18</span><span class="sc">:</span><span class="dv">22</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22</code></pre>
</div>
</div>
<p>기존 8부터 17까지의 숫자로 이루어진 v1 벡터에, <code>c()</code> 함수를 이용하여 새로운 값을 추가할 수 있습니다.</p>
<p>만약 벡터에서 원하는 부분의 데이터를 추출하려면 대괄호([])를 이용하면 됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>v1[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>v1[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  9 10 11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>v1[<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  9 11 13</code></pre>
</div>
</div>
<p>대괄호 안에 숫자를 입력하면, 벡터에서 해당 순서의 데이터가 추출됩니다. <strong>c(2,4,6)</strong>과 같이 특정 위치를 지정하여 데이터를 추출할 수도 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>v1[<span class="sc">-</span><span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  9 10 11 12 13 14 15 16 17</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>v1[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  8 10 12 14 16 17</code></pre>
</div>
</div>
<p>마이너스 기호를 입력하면, 해당 순서를 제외한 데이터가 추출됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>v1 <span class="sc">&lt;</span> <span class="dv">12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>v1[v1 <span class="sc">&lt;</span> <span class="dv">12</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  8  9 10 11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>v1[v1 <span class="sc">&lt;</span> <span class="dv">12</span> <span class="sc">|</span> v1 <span class="sc">&gt;</span> <span class="dv">15</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  8  9 10 11 16 17</code></pre>
</div>
</div>
<p>먼저 <strong>v1 &lt; 12</strong>를 입력하면 해당 조건에 해당하는 부분은 TRUE, 그렇지 않은 부분은 FALSE를 반환합니다. 그 후 대괄호 안에 다시 결과를 입력하면 TRUE에 해당하는 순서의 데이터만 반환합니다. 이처럼 대괄호 내부에 조건을 설정하여 원하는 데이터를 추출할 수도 있습니다.</p>
</section>
<section id="리스트-다루기" class="level3">
<h3 class="anchored" data-anchor-id="리스트-다루기">리스트 다루기</h3>
<p>먼저 리스트를 생성합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>l <span class="ot">=</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">'a'</span>, <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>), <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="fl">4.2</span>))</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(l)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 4
 $ : int [1:3] 1 2 3
 $ : chr "a"
 $ : logi [1:3] TRUE FALSE TRUE
 $ : num [1:2] 2.5 4.2</code></pre>
</div>
</div>
<p>첫번째 원소는 정수(int), 두번째 원소는 문자(chr), 세번째 원소는 논리값(logi), 네번째 원소는 숫자(num)로 이루어져 있습니다. 이처럼 리스트는 각 원소간 타입이나 길이가 달라도 데이터가 결합할 수 특징이 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>l2 <span class="ot">=</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="fu">list</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>)))</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(l2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 2
 $ : int [1:3] 1 2 3
 $ :List of 2
  ..$ : chr [1:5] "a" "b" "c" "d" ...
  ..$ : logi [1:3] TRUE FALSE TRUE</code></pre>
</div>
</div>
<p>위 예제에서 두번째 원소는 리스트로 구성되어 있습니다. 이처럼 리스트 내에 또 다른 리스트를 생성하는 것 역시 가능합니다.</p>
<p>이번에는 기존 리스트에 새로운 원소를 추가하도록 하겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>l3 <span class="ot">=</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">'a'</span>, <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>))</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>l4 <span class="ot">=</span> <span class="fu">append</span>(l3, <span class="fu">list</span>(<span class="fu">c</span>(<span class="fl">2.5</span>, <span class="fl">4.2</span>)))</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(l4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 1 2 3

[[2]]
[1] "a"

[[3]]
[1]  TRUE FALSE  TRUE

[[4]]
[1] 2.5 4.2</code></pre>
</div>
</div>
<p><code>append()</code> 함수를 이용하면 기존 리스트에 추가로 원소를 붙일 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>l4<span class="sc">$</span>item5 <span class="ot">=</span> <span class="st">'new list item'</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(l4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 1 2 3

[[2]]
[1] "a"

[[3]]
[1]  TRUE FALSE  TRUE

[[4]]
[1] 2.5 4.2

$item5
[1] "new list item"</code></pre>
</div>
</div>
<p>또한 기존 리스트에 달러 사인($)을 입력할 경우, 원소에 이름이 생성되며 데이터가 추가됩니다.</p>
<p>리스트에서 원하는 데이터를 추출할 때는, 벡터와 동일하게 대괄호를 이용하면 됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>l4[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 1 2 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>l4[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 1 2 3

[[2]]
[1]  TRUE FALSE  TRUE</code></pre>
</div>
</div>
<p>원소에 이름이 있을 경우, 이를 이용해 추출도 가능합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>l4[<span class="st">'item5'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$item5
[1] "new list item"</code></pre>
</div>
</div>
<p>원소의 이름인 <strong>item5</strong>를 입력하면 해당 원소만 반환합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>l4[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>l4<span class="sc">$</span>item5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "new list item"</code></pre>
</div>
</div>
<p>대괄호를 두번, 혹은 달러 사인($)을 이용해 데이터를 추출할 경우 원소 내의 형태가 반환되며, 위의 예제들과는 다르게 벡터 형태가 반환되었습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>l4[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>l4[[<span class="dv">1</span>]][<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
<p>특정 원소의 항목을 추출하기 위해서는 [[와 [를 함께 사용합니다. 위 예제는 l4 리스트의 첫번째 원소에서 3번째 항목을 추출하게 됩니다.</p>
</section>
<section id="데이터프레임-다루기" class="level3">
<h3 class="anchored" data-anchor-id="데이터프레임-다루기">데이터프레임 다루기</h3>
<p>데이터프레임은 R에서 가장 널리 사용되는 형식으로써, 각 컬럼이 다른 형태를 가질 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">data.frame</span> (<span class="at">col1 =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">col2 =</span> <span class="fu">c</span> (<span class="st">"this"</span>, <span class="st">"is"</span>, <span class="st">"text"</span>),</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">col3 =</span> <span class="fu">c</span> (<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>),</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">col4 =</span> <span class="fu">c</span> (<span class="fl">2.5</span>, <span class="fl">4.2</span>, pi))</span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   3 obs. of  4 variables:
 $ col1: int  1 2 3
 $ col2: chr  "this" "is" "text"
 $ col3: logi  TRUE FALSE TRUE
 $ col4: num  2.5 4.2 3.14</code></pre>
</div>
</div>
<p>col1은 숫자(int), col2는 문자(chr), col3는 논리연산자(logi), col4는 숫자(num)로 구성되어 있습니다. 또한 벡터 혹은 리스트를 이용해 데이터프레임을 생성할 수도 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>v1 <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>v2 <span class="ot">=</span> <span class="fu">c</span> (<span class="st">"this"</span>, <span class="st">"is"</span>, <span class="st">"text"</span>)</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>v3 <span class="ot">=</span> <span class="fu">c</span> (<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>)</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">col1 =</span> v1, <span class="at">col2 =</span> v2, <span class="at">col3 =</span> v3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  col1 col2  col3
1    1 this  TRUE
2    2   is FALSE
3    3 text  TRUE</code></pre>
</div>
</div>
<p>v1, v2, v3는 각각 숫자, 문자, 논리연산로 구성된 벡터입니다. 이를 <code>data.frame()</code> 함수 내에 입력할 경우 col1, col2, col3 열 이름에 해당 데이터들이 입력됩니다. 주의해야 할 점은 각 벡터의 길이가 동일해야 데이터프레임 형태를 만들 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>l <span class="ot">=</span> <span class="fu">list</span> (<span class="at">item1 =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">item2 =</span> <span class="fu">c</span> (<span class="st">"this"</span>, <span class="st">"is"</span>, <span class="st">"text"</span>),</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">item3 =</span> <span class="fu">c</span> (<span class="fl">2.5</span>, <span class="fl">4.2</span>, <span class="fl">5.1</span>))</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>l</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$item1
[1] 1 2 3

$item2
[1] "this" "is"   "text"

$item3
[1] 2.5 4.2 5.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(l)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  item1 item2 item3
1     1  this   2.5
2     2    is   4.2
3     3  text   5.1</code></pre>
</div>
</div>
<p>리스트 역시 <code>data.frame()</code> 함수를 이용할 경우, 각 원소명을 열이름으로 한 데이터프레임이 생성됩니다. 이 경우 역시 각 원소의 데이터 길이가 동일해야 합니다.</p>
<p>기존 데이터프레임에 행방향 혹은 열방향으로 데이터를 추가할 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  col1 col2  col3     col4
1    1 this  TRUE 2.500000
2    2   is FALSE 4.200000
3    3 text  TRUE 3.141593</code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>v4 <span class="ot">=</span> <span class="fu">c</span> (<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>)</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(df, v4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  col1 col2  col3     col4 v4
1    1 this  TRUE 2.500000  A
2    2   is FALSE 4.200000  B
3    3 text  TRUE 3.141593  C</code></pre>
</div>
</div>
<p><code>cbind()</code> 함수는 ’column bind’의 약어로써, 기존 데이터프레임에 새로운 열을 추가합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>v5 <span class="ot">=</span> <span class="fu">c</span> (<span class="dv">4</span>, <span class="st">"R"</span>, F, <span class="fl">1.1</span>)</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(df, v5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  col1 col2  col3             col4
1    1 this  TRUE              2.5
2    2   is FALSE              4.2
3    3 text  TRUE 3.14159265358979
4    4    R FALSE              1.1</code></pre>
</div>
</div>
<p><code>rbind()</code> 함수는 ’row bind’의 약어로써, 기존 데이터프레임에 새로운 행을 추가합니다. 주의할 점은 각 행의 데이터 형태가 기존 데이터의 형태와 일치해야 합니다.</p>
<p>데이터프레임 역시 대괄호를 이용해 데이터를 추출할 수 있으며, 공백으로 두면 모든 행(열)을 선택하게 됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  col1 col2  col3     col4
1    1 this  TRUE 2.500000
2    2   is FALSE 4.200000
3    3 text  TRUE 3.141593</code></pre>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>df[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  col1 col2  col3     col4
2    2   is FALSE 4.200000
3    3 text  TRUE 3.141593</code></pre>
</div>
</div>
<p>데이터프레임중 2:3, 즉 두번째부터 세번째까지의 행과 모든 열을 선택하게 됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>df[ , <span class="fu">c</span>(<span class="st">'col2'</span>, <span class="st">'col4'</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  col2     col4
1 this 2.500000
2   is 4.200000
3 text 3.141593</code></pre>
</div>
</div>
<p>행이름 혹은 열이름 직접 입력하여 해당값을 추출할 수도 있습니다. 위 예제에서는 열이름이 col2와 col4인 열을 추출합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>df[, <span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "this" "is"   "text"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>df[, <span class="dv">2</span>, drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  col2
1 this
2   is
3 text</code></pre>
</div>
</div>
<p>만일 하나의 열만 선택시 결과가 벡터 형태로 추출되며, drop = FALSE 인자를 추가해주면 데이터프레임의 형태가 유지되어 추출됩니다.</p>
</section>
<section id="결측치-처리하기" class="level3">
<h3 class="anchored" data-anchor-id="결측치-처리하기">결측치 처리하기</h3>
<p>결측치란 누락된 데이터를 의미하며, 데이터 분석에서 결측치를 처리하는 것은 매우 중요합니다. R에서 결측치는 <code>NA</code>로 표시되며, <code>is.na()</code> 함수를 통해 결측치 여부를 확인할 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="cn">NA</span>, <span class="dv">6</span><span class="sc">:</span><span class="dv">7</span>, <span class="cn">NA</span>)</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1  2  3  4 NA  6  7 NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.na</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE FALSE FALSE FALSE  TRUE FALSE FALSE  TRUE</code></pre>
</div>
</div>
<p>데이터가 NA인 경우에는 TRUE, 그렇지 않을 경우 FALSE를 반환합니다. 데이터프레임에도 해당 함수를 적용할 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">data.frame</span> (<span class="at">col1 =</span> <span class="fu">c</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="cn">NA</span>),</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">col2 =</span> <span class="fu">c</span> (<span class="st">"this"</span>, <span class="cn">NA</span>,<span class="st">"is"</span>, <span class="st">"text"</span>),</span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">col3 =</span> <span class="fu">c</span> (<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>),</span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">col4 =</span> <span class="fu">c</span> (<span class="fl">2.5</span>, <span class="fl">4.2</span>, <span class="fl">3.2</span>, <span class="cn">NA</span>)</span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a>                 )</span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  col1 col2  col3 col4
1    1 this  TRUE  2.5
2    2 &lt;NA&gt; FALSE  4.2
3    3   is  TRUE  3.2
4   NA text  TRUE   NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.na</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      col1  col2  col3  col4
[1,] FALSE FALSE FALSE FALSE
[2,] FALSE  TRUE FALSE FALSE
[3,] FALSE FALSE FALSE FALSE
[4,]  TRUE FALSE FALSE  TRUE</code></pre>
</div>
</div>
<p>데이터에 결측치가 있는 경우 계산이 불가능하다는 문제가 발생합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="cn">NA</span>, <span class="dv">4</span>)</span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
<p>데이터의 중간에 결측치인 NA가 존재하여 평균을 계산할 수 없으며, 이 외에도 모든 연산이 불가능하게 됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(y, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.666667</code></pre>
</div>
</div>
<p>na.rm에서 rm은 ’remove’의 약어입니다. 즉 해당 인자를 TRUE로 설정할 경우 NA를 제외하고 연산을 수행합니다. 따라서 1,3,4의 평균인 <span class="math inline">\(\frac{1+3+4}{3} = 2.6667\)</span>이 계산됩니다.</p>
<p>일반적으로 결측치가 있는 경우 해당 데이터는 문제가 있다고 판단하여 제거하거나, 다른 데이터로 대체하여 채워넣기도 합니다. 먼저 결측치가 있는 데이터를 제거하는 법을 알아보겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">data.frame</span> (<span class="at">col1 =</span> <span class="fu">c</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>),</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">col2 =</span> <span class="fu">c</span> (<span class="st">"this"</span>, <span class="cn">NA</span>,<span class="st">"is"</span>, <span class="st">"text"</span>),</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">col3 =</span> <span class="fu">c</span> (<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>),</span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">col4 =</span> <span class="fu">c</span> (<span class="fl">2.5</span>, <span class="fl">4.2</span>, <span class="fl">3.2</span>, <span class="fl">5.0</span>)</span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  col1 col2  col3 col4
1    1 this  TRUE  2.5
2    2 &lt;NA&gt; FALSE  4.2
3    3   is  TRUE  3.2
4    4 text  TRUE  5.0</code></pre>
</div>
</div>
<p>두번째 행 col2 열에 결측치가 있으므로, 해당 부분을 제거해주도록 합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">na.omit</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  col1 col2 col3 col4
1    1 this TRUE  2.5
3    3   is TRUE  3.2
4    4 text TRUE  5.0</code></pre>
</div>
</div>
<p><code>na.omit()</code> 함수를 이용하면 NA가 위치한 부분의 데이터가 제거됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="cn">NA</span>, <span class="dv">6</span><span class="sc">:</span><span class="dv">7</span>, <span class="cn">NA</span>)</span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1  2  3  4 NA  6  7 NA</code></pre>
</div>
</div>
<p>이번에는 위와 같이 결측치가 있는 경우, 다른 데이터로 대체하도록 하겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>x[<span class="fu">is.na</span>(x)] <span class="ot">=</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.000000 2.000000 3.000000 4.000000 3.833333 6.000000 7.000000 3.833333</code></pre>
</div>
</div>
<p><code>mean()</code> 함수 내부를 통해 값들의 평균을 구한 후, <code>is.na()</code> 함수를 통해 결측치가 위치한 부분의 데이터를 평균값인 3.833 으로 대체하였습니다. 이 외에도 결측치를 대체하는데는 다양한 방법이 존재합니다.</p>
</section>
</section>
<section id="데이터-불러오기-및-내보내기" class="level2">
<h2 class="anchored" data-anchor-id="데이터-불러오기-및-내보내기">데이터 불러오기 및 내보내기</h2>
<p>일반적으로 사람들은 csv 혹은 엑셀 파일로 저장된 데이터를 주고 받으며 데이터 분석을 하는 경우가 많습니다. 해당 형식의 파일을 R로 불러오는 법 그리고 저장하는 법에 대해 알아보겠습니다.</p>
<p>csv와 엑셀 샘플 파일의 주소는 다음과 같습니다.</p>
<ul>
<li>https://github.com/hyunyulhenry/dmmr_quant/blob/main/kospi.csv</li>
<li>https://github.com/hyunyulhenry/dmmr_quant/blob/main/kospi.xlsx</li>
</ul>
<p>아래의 코드를 실행하면 해당 파일을 PC에 다운로드 받을 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(<span class="st">'https://raw.githubusercontent.com/hyunyulhenry/dmmr_quant/master/kospi.csv'</span>, <span class="st">'kospi.csv'</span>)</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(<span class="st">'https://github.com/hyunyulhenry/dmmr_quant/raw/main/kospi.xlsx'</span>, <span class="st">'kospi.xlsx'</span>, <span class="at">mode =</span> <span class="st">'wb'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="워킹-디렉터리" class="level3">
<h3 class="anchored" data-anchor-id="워킹-디렉터리">워킹 디렉터리</h3>
<p>데이터를 불러오거나 내보낼 때 초보자들이 가장 많이 하는 실수가 워킹 디렉터리를 제대로 설정하지 않는 것입니다. 워킹 디렉터리(Working Directory)란 현재 사용중인 폴더를 의미하며, 현재 워킹 디렉터리는 콘솔창 상단 <code>getwd()</code> 함수를 통해 확인할 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a><span class="co"># [1] "C:/Users/henry/Documents/R/fin_ds"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>파일들이 A 폴더에 있는데 워킹 디렉터리가 B 폴더인 상태에서는 파일을 불러올 수 없으므로, 해당 파일들이 현재 워킹 디렉터리에 있어야 합니다.</p>
<p>워킹 디렉터리를 변경할때는 <code>setwd()</code> 함수를 통해 위치를 직접 지정해주어도 되지만, R 스튜디오의 파일 창을 이용하면 손쉽게 변경할 수 있습니다. 먼저 파일 창 상단의 […] 부분을 클릭합니다.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/r_basic/rbasic_setwd.png" class="lightbox" title="워킹 디렉터리 변경" data-gallery="quarto-lightbox-gallery-22"><img src="images/r_basic/rbasic_setwd.png" class="img-fluid figure-img"></a></p>
<p></p><figcaption class="figure-caption">워킹 디렉터리 변경</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>탐색기 화면에서 원하는 폴더를 선택한 후 하단의 [Open]을 클릭합니다.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/r_basic/rbasic_setwd2.png" class="lightbox" title="워킹 디렉터리 변경 (2)" data-gallery="quarto-lightbox-gallery-23"><img src="images/r_basic/rbasic_setwd2.png" class="img-fluid figure-img"></a></p>
<p></p><figcaption class="figure-caption">워킹 디렉터리 변경 (2)</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>탐색기 화면에 선택한 폴더의 파일들이 보입니다. 이제 [Move → Set As Working Directory]를 클릭하면 콘솔창에 해당 폴더를 워킹 디렉터리로 변경하는 코드가 입력되면서, 워킹 디렉터리 위치가 해당 폴더로 변경됩니다.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/r_basic/rbasic_setwd3.png" class="lightbox" title="워킹 디렉터리 변경 (3)" data-gallery="quarto-lightbox-gallery-24"><img src="images/r_basic/rbasic_setwd3.png" class="img-fluid figure-img"></a></p>
<p></p><figcaption class="figure-caption">워킹 디렉터리 변경 (3)</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="csv-파일-불러오기-및-저장하기" class="level3">
<h3 class="anchored" data-anchor-id="csv-파일-불러오기-및-저장하기">csv 파일 불러오기 및 저장하기</h3>
<p>먼저 R의 기본함수인 <code>read.csv()</code> 함수를 이용하면 매우 손쉽게 csv 파일을 불러올 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>kospi <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">'kospi.csv'</span>)</span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="co"># kospi = read.csv('kospi.csv', fileEncoding="UTF-8-BOM")</span></span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(kospi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Date   Close   Ret
1 2020-01-02 2175.17 -1.02
2 2020-01-03 2176.46  0.06
3 2020-01-06 2155.07 -0.98
4 2020-01-07 2175.54  0.95
5 2020-01-08 2151.31 -1.11
6 2020-01-09 2186.45  1.63</code></pre>
</div>
</div>
<p><code>readr</code> 패키지의 <code>read._csv()</code> 함수를 이용하면 기본 함수 대비 10배 정도 빠르게 데이터를 불러올 수 있으며, 훨씬 다양한 조건을 입력할 수도 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>kospi2 <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">'kospi.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 248 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl  (2): Close, Ret
date (1): Date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(kospi2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  Date       Close   Ret
  &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt;
1 2020-01-02 2175. -1.02
2 2020-01-03 2176.  0.06
3 2020-01-06 2155. -0.98
4 2020-01-07 2176.  0.95
5 2020-01-08 2151. -1.11
6 2020-01-09 2186.  1.63</code></pre>
</div>
</div>
<p>R의 데이터를 csv로 저장하는 법은 기본함수의 <code>write.csv()</code> 혹은 <code>readr</code> 패키지의 <code>write_csv()</code> 함수를 이용하면 됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using write.csv</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(kospi, <span class="st">'kospi2.csv'</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a><span class="co"># using write_csv</span></span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(kospi2, <span class="st">'kospi2.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>기본함수인 <code>write.csv()</code> 의 경우 행이름이 자동으로 새로운 열로 추가되어 저장되므로, 이를 원하지 않을 경우 <code>row.names = FALSE</code> 를 추가로 입력해주어야 합니다.</p>
</section>
<section id="엑셀-파일-불러오기-및-저장하기" class="level3">
<h3 class="anchored" data-anchor-id="엑셀-파일-불러오기-및-저장하기">엑셀 파일 불러오기 및 저장하기</h3>
<p>R의 기본함수 중에는 엑셀 파일을 불러오는 함수가 없지만, 해당 작업을 수행하는 다양한 패키지가 존재합니다. 그 중에서 <code>readr</code> 패키지와 쌍둥이 격인 <code>readxl</code> 패키지를 이용해보겠습니다.</p>
<p>먼저 해당 패키지의 <code>read_excel()</code> 함수를 이용해 엑셀 파일을 불러올 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>kospi_excel <span class="ot">=</span> <span class="fu">read_excel</span>(<span class="st">'kospi.xlsx'</span>, <span class="at">sheet =</span> <span class="st">'kospi'</span>)</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(kospi_excel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  Date                Close   Ret
  &lt;dttm&gt;              &lt;dbl&gt; &lt;dbl&gt;
1 2020-01-02 00:00:00 2175. -1.02
2 2020-01-03 00:00:00 2176.  0.06
3 2020-01-06 00:00:00 2155. -0.98
4 2020-01-07 00:00:00 2176.  0.95
5 2020-01-08 00:00:00 2151. -1.11
6 2020-01-09 00:00:00 2186.  1.63</code></pre>
</div>
</div>
<p>엑셀은 여러 시트로 구성된 경우가 많으며, sheet에 특정 시트명을 입력하면 해당 시트의 내용을 불러오게 됩니다. 만일 아무값도 입력하지 않을 경우 가장 첫번째 시트의 데이터를 불러옵니다.</p>
<p>반대로 R의 데이터를 엑셀로 저장하는 방법은 <code>writexl</code> 패키지의 <code>write_xlsx()</code> 함수를 이용하면 됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(writexl)</span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(kospi_excel, <span class="st">'kospi_excel.xlsx'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="효율성과-가독성-높이기" class="level2">
<h2 class="anchored" data-anchor-id="효율성과-가독성-높이기">효율성과 가독성 높이기</h2>
<p>이번에는 프로그래밍의 효율성을 높이기 위해 자주 사용되는 함수와 루프 구문, 그리고 가독성을 높이기 위한 파이프 오퍼레이터에 대해 알아보겠습니다.</p>
<section id="함수" class="level3">
<h3 class="anchored" data-anchor-id="함수">함수</h3>
<p>동일하거나 비슷한 작업을 반복해야 하는 경우 매번 실행하거나 복사-붙여넣기 하기 보다는 경우 함수를 작성하여 사용하면 매우 효율적으로 작업이 가능합니다.</p>
<p>함수는 크게 세가지 요소로 구성됩니다.</p>
<ul>
<li><code>body()</code>: 함수 내부의 코드</li>
<li><code>formals()</code>: 인자(argument) 내역</li>
<li><code>environment()</code>: 함수의 변수에 대한 위치</li>
</ul>
<p>예를 들어 금융 자산의 현재 가치는 다음과 같이 계산됩니다.</p>
<p><span class="math display">\[PV = FV / (1+r)^n\]</span></p>
<ul>
<li>PV: 현재 가치</li>
<li>FV: 미래 가치</li>
<li>r: 할인률</li>
<li>n: 기간</li>
</ul>
<p>즉, 1년 뒤에 110만원을 받는 돈의 현재가치는 <span class="math inline">\(110만원/(1+0.1)^1 = 100만원\)</span> 이라 볼 수 있습니다. 이러한 값을 구하기 위해 매번 계산기를 사용하기 보다는 함수를 이용하면, 훨씬 효율적인 작업이 가능합니다. 위의 수식을 함수로 나타내면 다음과 같습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>PV <span class="ot">=</span> <span class="cf">function</span>(FV, r, n) {</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>  PV <span class="ot">=</span> FV <span class="sc">/</span> (<span class="dv">1</span><span class="sc">+</span>r)<span class="sc">^</span>n</span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">round</span>(PV, <span class="dv">2</span>))</span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>R에서는 <code>함수명 = function(인자) {함수 내용}</code>의 형태로 함수를 만들수 있으며, 반환하고자 하는 결과를 <code>return()</code> 내부에 작성합니다. 함수의 구성요소 세가지를 한번 확인해보도록 하겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">body</span>(PV)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{
    PV = FV/(1 + r)^n
    return(round(PV, 2))
}</code></pre>
</div>
</div>
<p>먼저 body는 함수 내부의 코드를 의미합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">formals</span>(PV)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$FV


$r


$n</code></pre>
</div>
</div>
<p>formals에는 함수의 인자인 FV, r, n이 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">environment</span>(PV)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;environment: R_GlobalEnv&gt;</code></pre>
</div>
</div>
<p>함수는 GlobalEnv에 위치하고 있습니다.</p>
<p>이제 해당함수를 이용해 현재가치를 계산해보도록 하겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="fu">PV</span>(<span class="at">FV =</span> <span class="dv">1000</span>, <span class="at">r =</span> <span class="fl">0.08</span>, <span class="at">n =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 680.58</code></pre>
</div>
</div>
<p><span class="math inline">\(1000 / (1.08)^5\)</span>의 값인 680.58이 간단하게 계산됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="fu">PV</span>(<span class="dv">1000</span>, <span class="fl">0.08</span>, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 680.58</code></pre>
</div>
</div>
<p>만약 인자의 리스트를 생략하면, 입력한 순서대로 값이 입력됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">PV</span>(<span class="at">r =</span> <span class="fl">0.08</span>, <span class="at">FV =</span> <span class="dv">1000</span>, <span class="at">n =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 680.58</code></pre>
</div>
</div>
<p>인자의 내역을 정확하게 지정해준다면, 순서대로 입력하지 않아도 됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">PV</span>(<span class="dv">1000</span>, <span class="fl">0.08</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in PV(1000, 0.08): argument "n" is missing, with no default</code></pre>
</div>
</div>
<p><code>PV()</code> 함수에 필요한 인자는 3개인 반면, 2개만 입력하였으므로 에러가 발생합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>PV <span class="ot">=</span> <span class="cf">function</span>(<span class="at">FV =</span> <span class="dv">1000</span>, <span class="at">r =</span> .<span class="dv">08</span>, <span class="at">n =</span> <span class="dv">5</span>) {</span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>  PV <span class="ot">=</span> FV <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> r)<span class="sc">^</span>n</span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">round</span>(PV, <span class="dv">2</span>))</span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true" tabindex="-1"></a><span class="fu">PV</span>(<span class="dv">1000</span>, <span class="fl">0.08</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 680.58</code></pre>
</div>
</div>
<p>만일 함수의 인자에 디폴트 값이 입력되어 있다면, 함수 실행시 이를 생략하여도 디폴트 값이 입력됩니다. 위 예제에서는 n 디폴트 값으로 5가 들어가있으며, <code>PV()</code> 함수 내에 입력값이 3개만 입력될 경우 마지막 인자는 디폴트 값인 5를 적용합니다.</p>
</section>
<section id="루프-구문" class="level3">
<h3 class="anchored" data-anchor-id="루프-구문">루프 구문</h3>
<p>루프 및 각종 구문을 이용하여 휴율적인 작업을 하는것도 가능합니다.</p>
<section id="if-구문" class="level4">
<h4 class="anchored" data-anchor-id="if-구문"><code>if</code> 구문</h4>
<p>먼저 <code>if</code> 구문은 다음과 같이 구성됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (test_expression) {</span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>  statement</span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>괄호 안의 <strong>test_expression</strong>이 TRUE일 경우에만 statement 코드가 실행됩니다. 간단한 예제를 살펴보겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">3</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">5</span>)</span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">any</span>(x <span class="sc">&lt;</span> <span class="dv">0</span>)) {</span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">'x contains negative number'</span>)</span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "x contains negative number"</code></pre>
</div>
</div>
<p><code>any()</code> 함수는 적어도 하나의 값이 참이면 참으로 출력하는 함수입니다. 즉, 위의 코드는 x중 하나라도 0보다 작은 값이 있으면 <strong>x contains negative number</strong>라는 문장을 출력하며, -2가 0보다 작으므로 해당 문장을 출력합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">c</span> (<span class="dv">8</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">5</span>)</span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">any</span> (y <span class="sc">&lt;</span> <span class="dv">0</span>)) {</span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span> (<span class="st">"y contains negative numbers"</span>)</span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>이번에는 y에 0보다 작은 값이 없으므로, 구문이 실행되지 않아 문장을 출력하지 않습니다. 이처럼 <code>if</code> 구문만 존재할 시 이를 만족하지 않는 경우 아무런 구문도 실행되지 않습니다. 만일 조건을 충족하지 않을 때 동작을 추가하고 싶을 경우 <code>if else</code> 구문을 사용하며, 이는 if의 조건을 만족하지 않을 경우 else에 해당하는 구문이 실행됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (test_expression) {</span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>  statement <span class="dv">1</span></span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a>  statement <span class="dv">2</span></span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>만일 test_expression 구문이 TRUE이면 statement 1이 실행되며, 그렇지 않을 경우 statement 2가 실행됩니다. 실제 예제를 살펴봅시다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">c</span> (<span class="dv">8</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">5</span>)</span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">any</span> (y <span class="sc">&lt;</span> <span class="dv">0</span>)) {</span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span> (<span class="st">"y contains negative numbers"</span>)</span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span> (<span class="st">"y contains all positive numbers"</span>)</span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "y contains all positive numbers"</code></pre>
</div>
</div>
<p>y에 음수가 존재하는 <code>if</code> 구문이 FALSE 이므로, else에 해당하는 메세지가 출력됩니다. <code>ifelse</code> 구문은 <code>ifelse()</code> 함수로 간단히 나타낼 수도 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span> (<span class="dv">8</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">5</span>)</span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="fu">any</span>(x <span class="sc">&lt;</span> <span class="dv">0</span>), <span class="st">"x contains negative numbers"</span>, <span class="st">"x contains all positive numbers"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "x contains all positive numbers"</code></pre>
</div>
</div>
<p>해당 함수는 <code>ifelse(test, yes, no)</code> 형태로 입력되며, test를 충족하면 yes가 그렇지 않으면 no가 실행됩니다. 위의 예에서는 x에 0보다 작은 값이 없으므로, no에 해당하는 내용이 실행됩니다.</p>
<p>또한 <code>if</code>와 <code>else</code> 사이에 <code>else if</code> 조건을 통해, 여러 조건을 추가할 수도 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="dv">7</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (x <span class="sc">&gt;=</span> <span class="dv">10</span>) {</span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span> (<span class="st">"x exceeds acceptable tolerance levels"</span>)</span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span>(x <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> x <span class="sc">&lt;</span> <span class="dv">10</span>) {</span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span> (<span class="st">"x is within acceptable tolerance levels"</span>)</span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb229-7"><a href="#cb229-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span> (<span class="st">"x is negative"</span>)</span>
<span id="cb229-8"><a href="#cb229-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "x is within acceptable tolerance levels"</code></pre>
</div>
</div>
<p>위 조건은 다음과 같습니다.</p>
<ol type="1">
<li>x가 10 이상일 경우 <strong>x exceeds acceptable tolerance levels</strong>을 출력합니다.</li>
<li>만일 x가 10 이상, 10 미만일경우 <strong>x is within acceptable tolerance levels</strong>을 출력합니다.</li>
<li>그렇지 않을 경우 <strong>x is negative</strong>을 출력합니다.</li>
</ol>
<p>x는 7 이므로 else에 해당하는 내용이 출력됩니다.</p>
</section>
<section id="for-loop-구문" class="level4">
<h4 class="anchored" data-anchor-id="for-loop-구문"><code>for loop</code> 구문</h4>
<p><code>for loop</code> 구문은 특정한 부분의 코드가 반복적으로 수행될 수 있도록 하며, 다음과 같이 구성됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&lt;</span>code<span class="sc">:</span> do stuff here with i<span class="sc">&gt;</span></span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>먼저 i에 1이 들어간 뒤 code에 해당하는 부분이 실행됩니다. 그 후, i에 2가 들어간 뒤 다시 code가 실행되며 이 작업이 100까지 반복됩니다. 실제 예제를 살펴보도록 하겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2016</span><span class="sc">:</span><span class="dv">2020</span>) {</span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">=</span> <span class="fu">paste</span>(<span class="st">"The year is"</span>, i)</span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(output)</span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The year is 2016"
[1] "The year is 2017"
[1] "The year is 2018"
[1] "The year is 2019"
[1] "The year is 2020"</code></pre>
</div>
</div>
<p>i에 2010부터 2016 까지 대입되며, <strong>The year is</strong>라는 문자와 결합해 결과가 출력됩니다.</p>
</section>
<section id="apply-계열-함수" class="level4">
<h4 class="anchored" data-anchor-id="apply-계열-함수"><code>apply</code> 계열 함수</h4>
<p><code>apply</code> 계열의 함수는 loop 구문과 비슷한 역할을 하며, 코드를 훨씬 간결하게 표현할 수 있습니다. 먼저 가장 기본이 되는 <code>apply()</code> 함수는 데이터프레임의 행 혹은 열단위 계산에 자주 사용됩니다. 해당 함수는 다음과 같이 구성됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(x, MARGIN, FUN, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>x: 매트릭스, 데이터프레임, 혹은 어레이</li>
<li>MARGIN: 함수가 적용될 벡. 1은 행을, 2는 열을, c(1, 2)는 행과 열을 의미</li>
<li>FUN: 적용될 함수</li>
<li>…: 기타</li>
</ul>
<p>실제 사용 예제를 살펴보도록 하겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mtcars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   mpg cyl disp  hp drat    wt  qsec vs am gear carb
Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
</div>
</div>
<p>먼저 위 데이터에서 각 열의 평균을 구하도록 합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(mtcars, <span class="dv">2</span>, mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       mpg        cyl       disp         hp       drat         wt       qsec 
 20.090625   6.187500 230.721875 146.687500   3.596563   3.217250  17.848750 
        vs         am       gear       carb 
  0.437500   0.406250   3.687500   2.812500 </code></pre>
</div>
</div>
<p>mtcars에서 2 즉 열의 방향으로 평균(mean)을 구합니다.</p>
<p><code>lapply()</code> 함수는 리스트에 적용되며, 결과 또한 리스트로 반환됩니다. 해당 함수는 다음과 같이 구성됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(x, FUN, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>x: 리스트</li>
<li>FUN: 적용될 함수</li>
<li>…: 기타</li>
</ul>
<p>실제 사용 예제를 살펴보도록 하겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">list</span>(<span class="at">item1 =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">item2 =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>),</span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">item3 =</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">1</span>),</span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">item4 =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">5</span>))</span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$item1
[1] 1 2 3 4

$item2
 [1] -0.07803677  0.34528930  0.24123272  2.12271649 -0.24268921  0.15019808
 [7] -1.29730605 -0.24498821  0.82491208  0.73694285

$item3
 [1]  2.14916389  0.09457198  0.43886226 -0.14178466 -0.08788615  2.17000804
 [7]  1.11730177  2.37215003  1.78099767  2.87371514  0.22884739 -1.13561394
[13]  0.82305281  2.18234699  0.74901547 -0.07807229  1.27411424 -1.85805396
[19]  0.50041789  0.29959941

$item4
  [1] 3.845677 6.346175 5.702130 4.433262 5.143062 5.630058 5.106129 5.712749
  [9] 5.365632 4.549840 4.703099 3.204055 4.064953 4.053563 3.749023 6.034962
 [17] 5.098655 4.614874 5.430305 7.036957 5.428117 5.655748 5.178410 6.512606
 [25] 4.903527 4.793071 5.944694 5.877035 5.863774 2.977316 3.814279 4.218002
 [33] 5.169310 5.227394 4.180548 4.065250 3.303716 3.584812 5.293762 4.915582
 [41] 5.318408 6.278995 6.190713 5.271649 6.727153 6.774421 5.162596 4.702474
 [49] 3.661957 5.844167 5.419217 5.641847 4.907697 4.818963 5.327333 4.791673
 [57] 4.374438 3.625897 4.671151 3.660372 6.278229 5.185486 5.238512 5.546644
 [65] 5.169373 5.928340 3.963499 5.830896 4.797710 5.673212 4.119432 3.858571
 [73] 5.294791 2.220774 5.778793 5.615639 4.734069 4.445286 4.599742 5.102730
 [81] 6.296583 5.548517 5.334213 3.269071 5.146833 3.609878 4.808975 4.773671
 [89] 5.211274 3.176673 4.889657 3.791547 5.453448 3.566748 3.768427 5.473204
 [97] 5.197567 5.059498 3.923349 5.022317</code></pre>
</div>
</div>
<p>4개의 원소로 구성된 리스트에서 각 원소의 평균을 구하고자 할 경우, 리스트에 적용되는 apply인 <code>lapply()</code> 함수를 사용해야 합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(data, mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$item1
[1] 2.5

$item2
[1] 0.2558271

$item3
[1] 0.7876377

$item4
[1] 4.926064</code></pre>
</div>
</div>
<p><code>lapply()</code> 함수를 통해 각 항목의 평균을 구할 수 있으며, 결과 또한 리스트 형태로 반환됩니다. 해당 함수는 좀더 복잡한 형태로 응용도 가능합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a>beaver_data <span class="ot">=</span> <span class="fu">list</span>(<span class="at">beaver1 =</span> beaver1, <span class="at">beaver2 =</span> beaver2)</span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(beaver_data, head)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$beaver1
  day time  temp activ
1 346  840 36.33     0
2 346  850 36.34     0
3 346  900 36.35     0
4 346  910 36.42     0
5 346  920 36.55     0
6 346  930 36.69     0

$beaver2
  day time  temp activ
1 307  930 36.58     0
2 307  940 36.73     0
3 307  950 36.93     0
4 307 1000 37.15     0
5 307 1010 37.23     0
6 307 1020 37.24     0</code></pre>
</div>
</div>
<p>위 데이터의 각 항목에서 열 별 평균을 구하고자 할 경우 <code>lapply()</code> 함수 만으로는 계산이 불가능합니다. 이러한 경우 해당 함수 내부에 새로운 함수인 <code>function()</code>을 정의하여 복잡한 계산을 수행할 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(beaver_data, <span class="cf">function</span>(x) {</span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="fu">apply</span>(x, <span class="dv">2</span>, mean), <span class="dv">2</span>)</span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$beaver1
    day    time    temp   activ 
 346.20 1312.02   36.86    0.05 

$beaver2
    day    time    temp   activ 
 307.13 1446.20   37.60    0.62 </code></pre>
</div>
</div>
<p>function(x)를 통해 각 항목에 적용될 함수를 직접 정의할 수 있습니다. 우리가 정의한 함수는 <code>apply()</code> 함수를 통해 열의 방향으로 평균을 구한 뒤 소수 둘째 자리까지 반올림을 하는 것이며, 해당 함수가 리스트의 모든 원소에 적용됩니다.</p>
<p>마지막으로 살펴볼 <code>sapply()</code> 함수는 <code>lapply()</code> 함수와 거의 동일하며, 결과가 리스트가 아닌 벡터 혹은 매트릭스로 출력된다는 점만 차이가 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(beaver_data, <span class="cf">function</span>(x) {</span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="fu">apply</span>(x, <span class="dv">2</span>, mean), <span class="dv">2</span>)</span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$beaver1
    day    time    temp   activ 
 346.20 1312.02   36.86    0.05 

$beaver2
    day    time    temp   activ 
 307.13 1446.20   37.60    0.62 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(beaver_data, <span class="cf">function</span>(x) {</span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="fu">apply</span>(x, <span class="dv">2</span>, mean), <span class="dv">2</span>)</span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      beaver1 beaver2
day    346.20  307.13
time  1312.02 1446.20
temp    36.86   37.60
activ    0.05    0.62</code></pre>
</div>
</div>
<p><code>sapply()</code> 함수는 각 원소에 적용된 값을 벡터로 하는 매트릭스 형태로 결과값이 출력됩니다.</p>
</section>
<section id="기타-함수" class="level4">
<h4 class="anchored" data-anchor-id="기타-함수">기타 함수</h4>
<p>열과 행이 합계나 평균처럼 일반적으로 많이 사용되는 계산에는 <code>apply()</code> 함수보다 간단하게 표현할 수 있는 함수들이 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rowSums</span>(mtcars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Mazda RX4       Mazda RX4 Wag          Datsun 710      Hornet 4 Drive 
            328.980             329.795             259.580             426.135 
  Hornet Sportabout             Valiant          Duster 360           Merc 240D 
            590.310             385.540             656.920             270.980 
           Merc 230            Merc 280           Merc 280C          Merc 450SE 
            299.570             350.460             349.660             510.740 
         Merc 450SL         Merc 450SLC  Cadillac Fleetwood Lincoln Continental 
            511.500             509.850             728.560             726.644 
  Chrysler Imperial            Fiat 128         Honda Civic      Toyota Corolla 
            725.695             213.850             195.165             206.955 
      Toyota Corona    Dodge Challenger         AMC Javelin          Camaro Z28 
            273.775             519.650             506.085             646.280 
   Pontiac Firebird           Fiat X1-9       Porsche 914-2        Lotus Europa 
            631.175             208.215             272.570             273.683 
     Ford Pantera L        Ferrari Dino       Maserati Bora          Volvo 142E 
            670.690             379.590             694.710             288.890 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(mtcars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     mpg      cyl     disp       hp     drat       wt     qsec       vs 
 642.900  198.000 7383.100 4694.000  115.090  102.952  571.160   14.000 
      am     gear     carb 
  13.000  118.000   90.000 </code></pre>
</div>
</div>
<p><code>rowSums()</code> 함수는 행의 합계를, <code>colSums()</code> 함수는 열의 합계는 구하며 이는 <code>apply(mtcars, 1 or 2, sum)</code> 과 동일합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rowMeans</span>(mtcars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Mazda RX4       Mazda RX4 Wag          Datsun 710      Hornet 4 Drive 
           29.90727            29.98136            23.59818            38.73955 
  Hornet Sportabout             Valiant          Duster 360           Merc 240D 
           53.66455            35.04909            59.72000            24.63455 
           Merc 230            Merc 280           Merc 280C          Merc 450SE 
           27.23364            31.86000            31.78727            46.43091 
         Merc 450SL         Merc 450SLC  Cadillac Fleetwood Lincoln Continental 
           46.50000            46.35000            66.23273            66.05855 
  Chrysler Imperial            Fiat 128         Honda Civic      Toyota Corolla 
           65.97227            19.44091            17.74227            18.81409 
      Toyota Corona    Dodge Challenger         AMC Javelin          Camaro Z28 
           24.88864            47.24091            46.00773            58.75273 
   Pontiac Firebird           Fiat X1-9       Porsche 914-2        Lotus Europa 
           57.37955            18.92864            24.77909            24.88027 
     Ford Pantera L        Ferrari Dino       Maserati Bora          Volvo 142E 
           60.97182            34.50818            63.15545            26.26273 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>(mtcars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       mpg        cyl       disp         hp       drat         wt       qsec 
 20.090625   6.187500 230.721875 146.687500   3.596563   3.217250  17.848750 
        vs         am       gear       carb 
  0.437500   0.406250   3.687500   2.812500 </code></pre>
</div>
</div>
<p><code>rowMeans()</code> 함수와 <code>colMeans()</code> 함수 역시 각각 행과 열의 평균을 구합니다.</p>
</section>
</section>
<section id="파이프-오퍼레이터" class="level3">
<h3 class="anchored" data-anchor-id="파이프-오퍼레이터">파이프 오퍼레이터</h3>
<p>파이프 오퍼레이터는 R에서 동일한 데이터를 대상으로 연속으로 작업하게 해주는 오퍼레이터(연산자)입니다.</p>
<p>흔히 프로그래밍에서 x라는 데이터를 <code>F()</code>라는 함수에 넣어 결괏값을 확인하고 싶으면 <code>F(x)</code>의 방법을 사용합니다. 예를 들어 3과 5라는 데이터 중 큰 값을 찾으려면 <code>max(3,5)</code>를 통해 확인합니다. 이를 통해 나온 결괏값을 또 다시 <code>G()</code>라는 함수에 넣어 결괏값을 확인하려면 비슷한 과정을 거칩니다. <code>max(3,5)</code>를 통해 나온 값의 제곱근을 구하려면 <code>result = max(3,5)</code>를 통해 첫 번째 결괏값을 저장하고, <code>sqrt(result)</code>를 통해 두 번째 결괏값을 계산합니다. 물론 <code>sqrt(max(3,5))</code>와 같은 표현법으로 한 번에 표현할 수 있습니다.</p>
<p>이러한 표현의 단점은 계산하는 함수가 많아질수록 저장하는 변수가 늘어나거나 괄호가 지나치게 길어진다는 것입니다. 그러나 파이프 오퍼레이터인 <code>%&gt;%</code>를 사용하면 함수 간의 관계를 매우 직관적으로 표현하고 이해할 수 있습니다. 이를 정리하면 아래 표와 같습니다.</p>
<div class="cell">
<div class="cell-output-display">

<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>파이프 오퍼레이터의 표현과 내용 비교</caption>
 <thead>
  <tr>
   <th style="text-align:center;"> 내용 </th>
   <th style="text-align:center;"> 표현 방법 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:center;"> F(x) </td>
   <td style="text-align:center;"> x %&gt;% F </td>
  </tr>
  <tr>
   <td style="text-align:center;"> G(F(x)) </td>
   <td style="text-align:center;"> x %&gt;% F %&gt;% G </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>간단한 예제를 통해 파이프 오퍼레이터의 사용법을 살펴보겠습니다. 먼저 다음과 같은 10개의 숫자가 있다고 가정합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.3078</span>, <span class="fl">0.2577</span>, <span class="fl">0.5523</span>, <span class="fl">0.0564</span>, <span class="fl">0.4685</span>,</span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a>      <span class="fl">0.4838</span>, <span class="fl">0.8124</span>, <span class="fl">0.3703</span>, <span class="fl">0.5466</span>, <span class="fl">0.1703</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>우리가 원하는 과정은 다음과 같습니다.</p>
<ol type="1">
<li>각 값들의 로그값을 구할 것</li>
<li>로그값들의 계차를 구할 것</li>
<li>구해진 계차의 지수값을 구할 것</li>
<li>소수 둘째 자리까지 반올림할 것</li>
</ol>
<p>즉 <code>log()</code>, <code>diff()</code>, <code>exp()</code>, <code>round()</code>에 대한 값을 순차적으로 구하고자 합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">=</span> <span class="fu">log</span>(x)</span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">=</span> <span class="fu">diff</span>(x1)</span>
<span id="cb261-3"><a href="#cb261-3" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">=</span> <span class="fu">exp</span>(x2)</span>
<span id="cb261-4"><a href="#cb261-4" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(x3, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.84 2.14 0.10 8.31 1.03 1.68 0.46 1.48 0.31</code></pre>
</div>
</div>
<p>첫 번째 방법은 단계별 함수의 결괏값을 변수에 저장하고 저장된 변수를 다시 불러와 함수에 넣고 계산하는 방법입니다. 전반적인 계산 과정을 확인하기에는 좋지만 매번 변수에 저장하고 불러오는 과정이 매우 비효율적이며 코드도 불필요하게 길어집니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">exp</span>(<span class="fu">diff</span>(<span class="fu">log</span>(x))), <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.84 2.14 0.10 8.31 1.03 1.68 0.46 1.48 0.31</code></pre>
</div>
</div>
<p>두 번째는 괄호를 통해 감싸는 방법입니다. 앞선 방법에 비해 코드는 짧아졌지만, 계산 과정을 알아보기에는 매우 불편한 방법으로 코드가 짜여 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-3"><a href="#cb265-3" aria-hidden="true" tabindex="-1"></a>x <span class="sc">%&gt;%</span> <span class="fu">log</span>() <span class="sc">%&gt;%</span> <span class="fu">diff</span>() <span class="sc">%&gt;%</span> <span class="fu">exp</span>() <span class="sc">%&gt;%</span> <span class="fu">round</span>(., <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.84 2.14 0.10 8.31 1.03 1.68 0.46 1.48 0.31</code></pre>
</div>
</div>
<p>마지막으로 파이프 오퍼레이터를 사용하는 방법입니다. 코드도 짧으며 계산 과정을 한눈에 파악하기도 좋습니다. 맨 왼쪽에는 원하는 변수를 입력하며, %&gt;% 뒤에는 차례대로 계산하고자 하는 함수를 입력합니다. 변수의 입력값을 ()로 비워둘 경우, 오퍼레이터의 왼쪽에 있는 값이 입력 변수가 됩니다. 반면 <code>round()</code>와 같이 입력값이 두 개 이상 필요하면 마침표(.)가 오퍼레이터의 왼쪽 값으로 입력됩니다.</p>
<p>파이프 오퍼레이터는 크롤링뿐만 아니라 모든 코드에 사용할 수 있습니다. 이를 통해 훨씬 깔끔하면서도 데이터 처리 과정을 직관적으로 이해할 수 있습니다.</p>
</section>
</section>
<section id="데이터-구조-변형하기" class="level2">
<h2 class="anchored" data-anchor-id="데이터-구조-변형하기">데이터 구조 변형하기</h2>
<p>기본적인 R 사용법을 익혔다면 데이터의 모양을 바꾸고 가공하여 내가 원하는 결과물을 출력해야 합니다. 해당 작업은 <code>tidyr</code> 패키지와 <code>dplyr</code> 패키지를 이용해 매우 효율적으로 수행할 수 있으며, dplyr 패키지의 함수 중 일부는 SQL 구문과 매우 유사합니다.</p>
<section id="tidyr-패키지를-이용한-데이터-모양-바꾸기" class="level3">
<h3 class="anchored" data-anchor-id="tidyr-패키지를-이용한-데이터-모양-바꾸기"><code>tidyr</code> 패키지를 이용한 데이터 모양 바꾸기</h3>
<p>깔끔한 데이터(tidy data)는 다음과 같이 구성되어 있습니다.</p>
<ul>
<li>각 변수(variable)는 열로 구성됩니다.</li>
<li>각 관측값(observation)은 행으로 구성됩니다.</li>
<li>각 타입의 관측치는 테이블을 구성합니다.</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/r_basic/rbasic_tidy.png" class="lightbox" title="tidy 데이터 요건" data-gallery="quarto-lightbox-gallery-25"><img src="images/r_basic/rbasic_tidy.png" class="img-fluid figure-img"></a></p>
<p></p><figcaption class="figure-caption">tidy 데이터 요건</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><code>tidyr</code> 패키지에는 이러한 깔끔한 데이터를 만드는데 필요한 여러 함수가 있습니다.</p>
<section id="pivot_longer-세로로-긴-데이터-만들기" class="level4">
<h4 class="anchored" data-anchor-id="pivot_longer-세로로-긴-데이터-만들기"><code>pivot_longer()</code>: 세로로 긴 데이터 만들기</h4>
<p>먼저 가로로 긴(Wide) 데이터를 세로로 길게 만드는데는 <code>pivot_longer()</code> 함수가 사용됩니다. 이 함수는 여러 열을 key-value 페어로 변형해줍니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'tidyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:magrittr':

    extract</code></pre>
</div>
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a>table4a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  country     `1999` `2000`
* &lt;chr&gt;        &lt;int&gt;  &lt;int&gt;
1 Afghanistan    745   2666
2 Brazil       37737  80488
3 China       212258 213766</code></pre>
</div>
</div>
<p>위 예제에는 세 국가의 1999, 2000년 데이터가 있습니다. 이 중 country를 제외한 연도별 데이터를 세로로 길게 만들도록 하겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a>long <span class="ot">=</span> table4a <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="at">names_to =</span> <span class="st">'years'</span>, <span class="at">values_to =</span> <span class="st">'cases'</span>, <span class="sc">-</span>country)</span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  country     years  cases
  &lt;chr&gt;       &lt;chr&gt;  &lt;int&gt;
1 Afghanistan 1999     745
2 Afghanistan 2000    2666
3 Brazil      1999   37737
4 Brazil      2000   80488
5 China       1999  212258
6 China       2000  213766</code></pre>
</div>
</div>
<p>열 이름에 해당하던 1999, 2000 데이터가 names_to에 입력한 years 열에 입력되었습니다. 또한 각 관측값이 values_to에 입력한 cases 열에 입력되었습니다. country 앞에는 마이너스(-) 기호를 붙여 해당 열은 그대로 유지됩니다.</p>
<div class="cell">
<div class="cell-output-display">

<table class="kable_wrapper table table-striped" style="margin-left: auto; margin-right: auto;">
<tbody>
  <tr>
   <td> 

<table>
 <thead>
  <tr>
   <th style="text-align:left;"> country </th>
   <th style="text-align:right;"> 1999 </th>
   <th style="text-align:right;"> 2000 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Afghanistan </td>
   <td style="text-align:right;"> 745 </td>
   <td style="text-align:right;"> 2666 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Brazil </td>
   <td style="text-align:right;"> 37737 </td>
   <td style="text-align:right;"> 80488 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> China </td>
   <td style="text-align:right;"> 212258 </td>
   <td style="text-align:right;"> 213766 </td>
  </tr>
</tbody>
</table>

 </td>
   <td> 

<table>
 <thead>
  <tr>
   <th style="text-align:left;"> country </th>
   <th style="text-align:left;"> years </th>
   <th style="text-align:right;"> cases </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Afghanistan </td>
   <td style="text-align:left;"> 1999 </td>
   <td style="text-align:right;"> 745 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Afghanistan </td>
   <td style="text-align:left;"> 2000 </td>
   <td style="text-align:right;"> 2666 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Brazil </td>
   <td style="text-align:left;"> 1999 </td>
   <td style="text-align:right;"> 37737 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Brazil </td>
   <td style="text-align:left;"> 2000 </td>
   <td style="text-align:right;"> 80488 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> China </td>
   <td style="text-align:left;"> 1999 </td>
   <td style="text-align:right;"> 212258 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> China </td>
   <td style="text-align:left;"> 2000 </td>
   <td style="text-align:right;"> 213766 </td>
  </tr>
</tbody>
</table>

 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="pivot_wider-가로로-긴-데이터-만들기" class="level4">
<h4 class="anchored" data-anchor-id="pivot_wider-가로로-긴-데이터-만들기"><code>pivot_wider()</code>: 가로로 긴 데이터 만들기</h4>
<p><code>pivot_longer()</code> 함수와 반대로, <code>pivot_wider()</code> 함수를 이용할 경우 세로로 긴 데이터를 가로로 길게 만들 수 있습니다. 위의 데이터에 year 열에 있는 항목들을 열 이름으로, cases 열에 있는 항목들을 가로로 길게 되돌려 보겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a>back2wide <span class="ot">=</span> long <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">'years'</span>, <span class="at">values_from =</span> <span class="st">'cases'</span>)</span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(back2wide)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  country     `1999` `2000`
  &lt;chr&gt;        &lt;int&gt;  &lt;int&gt;
1 Afghanistan    745   2666
2 Brazil       37737  80488
3 China       212258 213766</code></pre>
</div>
</div>
<p>names_from와 values_from에 각각 열이름 및 관측값에 해당하는 값을 입력하면, 원래대로 가로로 긴 테이블 형태가 되었습니다.</p>
</section>
<section id="separate-하나의-열을-여러-열로-나누기" class="level4">
<h4 class="anchored" data-anchor-id="separate-하나의-열을-여러-열로-나누기"><code>separate()</code>: 하나의 열을 여러 열로 나누기</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a>table3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  country      year rate             
* &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;            
1 Afghanistan  1999 745/19987071     
2 Afghanistan  2000 2666/20595360    
3 Brazil       1999 37737/172006362  
4 Brazil       2000 80488/174504898  
5 China        1999 212258/1272915272
6 China        2000 213766/1280428583</code></pre>
</div>
</div>
<p>rate 열에는 데이터가 ###/#### 형태로 들어가 있습니다. / 기호를 기준으로 앞과 뒤로 각각 나누어보도록 하겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a>table3 <span class="sc">%&gt;%</span> </span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(rate, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"cases"</span>, <span class="st">"population"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country      year cases  population
  &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;     
1 Afghanistan  1999 745    19987071  
2 Afghanistan  2000 2666   20595360  
3 Brazil       1999 37737  172006362 
4 Brazil       2000 80488  174504898 
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>
</div>
</div>
<p><code>separate()</code> 함수를 사용할 경우 rate 열이 “/”를 기준으로 into에 입력한 cases와 population 열로 분리됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a>table3 <span class="sc">%&gt;%</span> </span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(rate, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"cases"</span>, <span class="st">"population"</span>), <span class="at">remove =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  country      year rate              cases  population
  &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;             &lt;chr&gt;  &lt;chr&gt;     
1 Afghanistan  1999 745/19987071      745    19987071  
2 Afghanistan  2000 2666/20595360     2666   20595360  
3 Brazil       1999 37737/172006362   37737  172006362 
4 Brazil       2000 80488/174504898   80488  174504898 
5 China        1999 212258/1272915272 212258 1272915272
6 China        2000 213766/1280428583 213766 1280428583</code></pre>
</div>
</div>
<p>remove = FALSE 인자를 추가해주면 원래의 열이 사라지지 않고 유지됩니다.</p>
</section>
<section id="unite-여러-열을-하나로-합치기" class="level4">
<h4 class="anchored" data-anchor-id="unite-여러-열을-하나로-합치기"><code>unite()</code>: 여러 열을 하나로 합치기</h4>
<p><code>separate()</code> 함수와는 반대로, <code>unite()</code> 함수를 이용시 여러 열을 하나로 합칠 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a>table5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country     century year  rate             
* &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;            
1 Afghanistan 19      99    745/19987071     
2 Afghanistan 20      00    2666/20595360    
3 Brazil      19      99    37737/172006362  
4 Brazil      20      00    80488/174504898  
5 China       19      99    212258/1272915272
6 China       20      00    213766/1280428583</code></pre>
</div>
</div>
<p>이번에는 century와 year 열을 합친 후 새로운 열을 만들어보도록 하겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a>table5 <span class="sc">%&gt;%</span> </span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(new, century, year, <span class="at">sep =</span> <span class="st">"_"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  country     new   rate             
  &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;            
1 Afghanistan 19_99 745/19987071     
2 Afghanistan 20_00 2666/20595360    
3 Brazil      19_99 37737/172006362  
4 Brazil      20_00 80488/174504898  
5 China       19_99 212258/1272915272
6 China       20_00 213766/1280428583</code></pre>
</div>
</div>
<p>century 열과 year열이 합쳐진 후 new 열에 입력되었으며, sep 인자를 통해 구분자는 “_”로 설정하였습니다.</p>
</section>
<section id="tidyr-패키지의-기타-함수" class="level4">
<h4 class="anchored" data-anchor-id="tidyr-패키지의-기타-함수"><code>tidyr</code> 패키지의 기타 함수</h4>
<p>먼저 <code>fill()</code> 함수는 결측치를 채워주는 역할을 합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a>score <span class="ot">=</span> <span class="fu">tribble</span>(</span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span> person, <span class="sc">~</span> Math, <span class="sc">~</span> Computer,</span>
<span id="cb286-3"><a href="#cb286-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Henry"</span>,  <span class="dv">1</span>,         <span class="dv">7</span>,</span>
<span id="cb286-4"><a href="#cb286-4" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NA</span>,       <span class="dv">2</span>,         <span class="dv">10</span>,</span>
<span id="cb286-5"><a href="#cb286-5" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NA</span>,       <span class="cn">NA</span>,        <span class="dv">9</span>,</span>
<span id="cb286-6"><a href="#cb286-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"David"</span>,  <span class="dv">1</span>,         <span class="dv">4</span></span>
<span id="cb286-7"><a href="#cb286-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb286-8"><a href="#cb286-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-9"><a href="#cb286-9" aria-hidden="true" tabindex="-1"></a>score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  person  Math Computer
  &lt;chr&gt;  &lt;dbl&gt;    &lt;dbl&gt;
1 Henry      1        7
2 &lt;NA&gt;       2       10
3 &lt;NA&gt;      NA        9
4 David      1        4</code></pre>
</div>
</div>
<p>score의 2번째와 3번째 행에 NA 데이터가 있어 이를 채워줄 필요가 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb288"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a>score <span class="sc">%&gt;%</span> </span>
<span id="cb288-2"><a href="#cb288-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fill</span>(person, Math)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  person  Math Computer
  &lt;chr&gt;  &lt;dbl&gt;    &lt;dbl&gt;
1 Henry      1        7
2 Henry      2       10
3 Henry      2        9
4 David      1        4</code></pre>
</div>
</div>
<p><code>fill()</code> 함수는 결측치가 있을 경우, 각 열의 이전 데이터를 이용해 채워줍니다. 반면에 NA 데이터를 특정 값으로 변경할 수도 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb290"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a>score <span class="sc">%&gt;%</span> <span class="fu">replace_na</span>(<span class="at">replace =</span> <span class="fu">list</span>(<span class="at">person =</span> <span class="st">"unknown"</span>, <span class="at">Math =</span> <span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  person   Math Computer
  &lt;chr&gt;   &lt;dbl&gt;    &lt;dbl&gt;
1 Henry       1        7
2 unknown     2       10
3 unknown     0        9
4 David       1        4</code></pre>
</div>
</div>
<p><code>replace_na()</code> 함수를 이용해 person 열의 NA 데이터를 <strong>unknown</strong>으로, Math열의 NA 데이터를 0으로 변경하였습니다.</p>
</section>
</section>
<section id="dplyr-패키지를-이용한-데이터-변형하기" class="level3">
<h3 class="anchored" data-anchor-id="dplyr-패키지를-이용한-데이터-변형하기"><code>dplyr</code> 패키지를 이용한 데이터 변형하기</h3>
<p>데이터를 필터링 하거나, 요약하거나, 정렬하거나, 새로운 변수를 만드는 등 데이터 분석을 위해서는 데이터 변형하고 가공해야 하는 경우가 많습니다. R의 기본 함수도 이러한 기능을 제공하지만, <code>dplyr</code> 패키지를 이용할 경우 훨씬 빠르고 효율적으로 업무를 처리할 수 있습니다.</p>
<p>nycflights13 패키지의 flights 데이터셋을 예제로 사용하도록 하겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:kableExtra':

    group_rows</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nycflights13)</span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a>flights</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 19
    year month   day dep_time sched_de…¹ dep_d…² arr_t…³ sched…⁴ arr_d…⁵ carrier
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;      &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;  
 1  2013     1     1      517        515       2     830     819      11 UA     
 2  2013     1     1      533        529       4     850     830      20 UA     
 3  2013     1     1      542        540       2     923     850      33 AA     
 4  2013     1     1      544        545      -1    1004    1022     -18 B6     
 5  2013     1     1      554        600      -6     812     837     -25 DL     
 6  2013     1     1      554        558      -4     740     728      12 UA     
 7  2013     1     1      555        600      -5     913     854      19 B6     
 8  2013     1     1      557        600      -3     709     723     -14 EV     
 9  2013     1     1      557        600      -3     838     846      -8 B6     
10  2013     1     1      558        600      -2     753     745       8 AA     
# … with 336,766 more rows, 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;,
#   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, and abbreviated variable names
#   ¹​sched_dep_time, ²​dep_delay, ³​arr_time, ⁴​sched_arr_time, ⁵​arr_delay</code></pre>
</div>
</div>
<section id="select-원하는-열-선택하기" class="level4">
<h4 class="anchored" data-anchor-id="select-원하는-열-선택하기"><code>select()</code>: 원하는 열 선택하기</h4>
<p><code>select()</code> 함수를 이용해 특정 열만을 선택할 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb299"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> <span class="fu">select</span>(year, month, day) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
   year month   day
  &lt;int&gt; &lt;int&gt; &lt;int&gt;
1  2013     1     1
2  2013     1     1
3  2013     1     1
4  2013     1     1
5  2013     1     1
6  2013     1     1</code></pre>
</div>
</div>
<p><code>select()</code> 함수 내에 선택하고자 하는 열을 입력하여 year, month, day 열을 선택했습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb301"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> <span class="fu">select</span>(year<span class="sc">:</span>day) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
   year month   day
  &lt;int&gt; &lt;int&gt; &lt;int&gt;
1  2013     1     1
2  2013     1     1
3  2013     1     1
4  2013     1     1
5  2013     1     1
6  2013     1     1</code></pre>
</div>
</div>
<p>콜론(:)을 이용해 year부터 day 까지의 열을 한번에 선택할 수도 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb303"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>(year<span class="sc">:</span>day)) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 16
  dep_time sched…¹ dep_d…² arr_t…³ sched…⁴ arr_d…⁵ carrier flight tailnum origin
     &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;   &lt;chr&gt; 
1      517     515       2     830     819      11 UA        1545 N14228  EWR   
2      533     529       4     850     830      20 UA        1714 N24211  LGA   
3      542     540       2     923     850      33 AA        1141 N619AA  JFK   
4      544     545      -1    1004    1022     -18 B6         725 N804JB  JFK   
5      554     600      -6     812     837     -25 DL         461 N668DN  LGA   
6      554     558      -4     740     728      12 UA        1696 N39463  EWR   
# … with 6 more variables: dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
#   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, and abbreviated variable names
#   ¹​sched_dep_time, ²​dep_delay, ³​arr_time, ⁴​sched_arr_time, ⁵​arr_delay</code></pre>
</div>
</div>
<p>마이너스(-)를 이용할 경우 해당 열을 제외한 모든 열이 선택됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb305"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"dep"</span>)) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  dep_time dep_delay
     &lt;int&gt;     &lt;dbl&gt;
1      517         2
2      533         4
3      542         2
4      544        -1
5      554        -6
6      554        -4</code></pre>
</div>
</div>
<p><code>select()</code> 함수 내에 <code>starts_with()</code> 함수를 이용할 경우, 해당 문자로 시작하는 열을 모두 선택할 수 있습니다. 이 외에도 <code>ends_with()</code> 함수는 해당 문자로 끝나는 열울, <code>contains()</code> 함수는 해당 문자가 포함되는 열을 선택합니다.</p>
</section>
<section id="rename-열이름-바꾸기" class="level4">
<h4 class="anchored" data-anchor-id="rename-열이름-바꾸기"><code>rename()</code>: 열이름 바꾸기</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">tail_num =</span> tailnum) <span class="sc">%&gt;%</span> <span class="fu">select</span>(tail_num) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 1
  tail_num
  &lt;chr&gt;   
1 N14228  
2 N24211  
3 N619AA  
4 N804JB  
5 N668DN  
6 N39463  </code></pre>
</div>
</div>
<p><code>rename()</code> 함수를 이용해 <strong>tailnum</strong> 이던 열 이름을 <strong>tail_num</strong> 으로 변경하였습니다. 해당 함수는 <code>rename(변경하고자 하는 이름 = 변경전 이름)</code> 형태로 입력해야 합니다.</p>
</section>
<section id="filter-필터링" class="level4">
<h4 class="anchored" data-anchor-id="filter-필터링"><code>filter()</code>: 필터링</h4>
<p>특정 열에 원하는 데이터가 있는 부분만 필터링을 해야하는 경우가 많으며, <code>filter()</code> 함수를 사용해 손쉽게 해결할 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb309"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> <span class="fu">filter</span>(month <span class="sc">==</span> <span class="dv">3</span>, day <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 19
   year month   day dep_time sched_dep…¹ dep_d…² arr_t…³ sched…⁴ arr_d…⁵ carrier
  &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;       &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;  
1  2013     3     1        4        2159     125     318      56     142 B6     
2  2013     3     1       50        2358      52     526     438      48 B6     
3  2013     3     1      117        2245     152     223    2354     149 B6     
4  2013     3     1      454         500      -6     633     648     -15 US     
5  2013     3     1      505         515     -10     746     810     -24 UA     
6  2013     3     1      521         530      -9     813     827     -14 UA     
# … with 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;,
#   dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;,
#   time_hour &lt;dttm&gt;, and abbreviated variable names ¹​sched_dep_time,
#   ²​dep_delay, ³​arr_time, ⁴​sched_arr_time, ⁵​arr_delay</code></pre>
</div>
</div>
<p><code>filter()</code> 함수 내에 필터링 하고자 하는 조건, 즉 month가 3이고 day가 1인 조건을 입력하면 해당 조건에 부합하는 행만 선택됩니다.</p>
</section>
<section id="summarize-요약값-계산하기" class="level4">
<h4 class="anchored" data-anchor-id="summarize-요약값-계산하기"><code>summarize()</code>: 요약값 계산하기</h4>
<p>요약 통계값은 <code>summarize()</code> 함수를 통해 쉽게 계산할 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb311"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">max_dep =</span> <span class="fu">max</span>(dep_time, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb311-2"><a href="#cb311-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">min_dep =</span> <span class="fu">min</span>(dep_time, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  max_dep min_dep
    &lt;int&gt;   &lt;int&gt;
1    2400       1</code></pre>
</div>
</div>
<p><code>summarize()</code> 함수를 통해 max_dep에는 dep_time의 최대값을, min_dep에는 dep_time의 최소값을 구해줍니다. <strong>na.rm</strong> 인자를 TRUE로 설정하여 NA 데이터는 제거해 줍니다.</p>
</section>
<section id="group_by-원하는-조건으로-그룹화" class="level4">
<h4 class="anchored" data-anchor-id="group_by-원하는-조건으로-그룹화"><code>group_by()</code>: 원하는 조건으로 그룹화</h4>
<p>각 그룹별 통계량을 계산할 때는 <code>group_by()</code> 함수를 통해 그룹을 묶고, 계산하는 것이 편합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb313"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a>by_day <span class="ot">=</span> flights <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(year, month, day)</span>
<span id="cb313-2"><a href="#cb313-2" aria-hidden="true" tabindex="-1"></a>by_day <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 19
# Groups:   year, month, day [1]
   year month   day dep_time sched_dep…¹ dep_d…² arr_t…³ sched…⁴ arr_d…⁵ carrier
  &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;       &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;  
1  2013     1     1      517         515       2     830     819      11 UA     
2  2013     1     1      533         529       4     850     830      20 UA     
3  2013     1     1      542         540       2     923     850      33 AA     
4  2013     1     1      544         545      -1    1004    1022     -18 B6     
5  2013     1     1      554         600      -6     812     837     -25 DL     
6  2013     1     1      554         558      -4     740     728      12 UA     
# … with 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;,
#   dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;,
#   time_hour &lt;dttm&gt;, and abbreviated variable names ¹​sched_dep_time,
#   ²​dep_delay, ³​arr_time, ⁴​sched_arr_time, ⁵​arr_delay</code></pre>
</div>
</div>
<p>year, month, day를 기준으로 그룹을 묶었습니다. 아직 계산을 하지 않았으므로 출력되는 데이터프레임 자체는 원래와 동일하며, <strong>Groups</strong>를 통해 어떠한 조건으로 그룹이 묶여있는지 확인됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb315"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a>by_day <span class="sc">%&gt;%</span></span>
<span id="cb315-2"><a href="#cb315-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">delay =</span> <span class="fu">mean</span>(dep_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb315-3"><a href="#cb315-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
# Groups:   year, month [1]
   year month   day delay
  &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
1  2013     1     1 11.5 
2  2013     1     2 13.9 
3  2013     1     3 11.0 
4  2013     1     4  8.95
5  2013     1     5  5.73
6  2013     1     6  7.15</code></pre>
</div>
</div>
<p>해당 데이터는 그룹별로 묶여 있으므로, <code>summarise()</code> 함수를 적용하면 각 그룹(year, month, day) 별로 dep_delay의 평균을 구합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb318"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(dest) <span class="sc">%&gt;%</span></span>
<span id="cb318-2"><a href="#cb318-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb318-3"><a href="#cb318-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb318-4"><a href="#cb318-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">dist =</span> <span class="fu">mean</span>(distance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb318-5"><a href="#cb318-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">delay =</span> <span class="fu">mean</span>(arr_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb318-6"><a href="#cb318-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 105 × 4
   dest  count  dist delay
   &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 ABQ     254 1826   4.38
 2 ACK     265  199   4.85
 3 ALB     439  143  14.4 
 4 ANC       8 3370  -2.5 
 5 ATL   17215  757. 11.3 
 6 AUS    2439 1514.  6.02
 7 AVL     275  584.  8.00
 8 BDL     443  116   7.05
 9 BGR     375  378   8.03
10 BHM     297  866. 16.9 
# … with 95 more rows</code></pre>
</div>
</div>
<p>한 번에 여러 통계량을 계산할 수도 있으며, <code>n()</code>은 데이터의 갯수를 의미합니다.</p>
</section>
<section id="arrange-데이터-정렬하기" class="level4">
<h4 class="anchored" data-anchor-id="arrange-데이터-정렬하기"><code>arrange()</code>: 데이터 정렬하기</h4>
<p><code>arrange()</code> 함수를 통해 원하는 열을 기준으로 데이터를 순서대로 정렬할 수 있으며, 오름차순을 기본으로 합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb320"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb320-1"><a href="#cb320-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(year, month, day) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 19
   year month   day dep_time sched_dep…¹ dep_d…² arr_t…³ sched…⁴ arr_d…⁵ carrier
  &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;       &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;  
1  2013     1     1      517         515       2     830     819      11 UA     
2  2013     1     1      533         529       4     850     830      20 UA     
3  2013     1     1      542         540       2     923     850      33 AA     
4  2013     1     1      544         545      -1    1004    1022     -18 B6     
5  2013     1     1      554         600      -6     812     837     -25 DL     
6  2013     1     1      554         558      -4     740     728      12 UA     
# … with 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;,
#   dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;,
#   time_hour &lt;dttm&gt;, and abbreviated variable names ¹​sched_dep_time,
#   ²​dep_delay, ³​arr_time, ⁴​sched_arr_time, ⁵​arr_delay</code></pre>
</div>
</div>
<p><code>arrange()</code> 함수 내에 입력한 [year -&gt; month -&gt; day] 순으로 오름차순 정렬이 됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb322"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb322-1"><a href="#cb322-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(dep_delay)) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 19
   year month   day dep_time sched_dep…¹ dep_d…² arr_t…³ sched…⁴ arr_d…⁵ carrier
  &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;       &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;  
1  2013     1     9      641         900    1301    1242    1530    1272 HA     
2  2013     6    15     1432        1935    1137    1607    2120    1127 MQ     
3  2013     1    10     1121        1635    1126    1239    1810    1109 MQ     
4  2013     9    20     1139        1845    1014    1457    2210    1007 AA     
5  2013     7    22      845        1600    1005    1044    1815     989 MQ     
6  2013     4    10     1100        1900     960    1342    2211     931 DL     
# … with 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;,
#   dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;,
#   time_hour &lt;dttm&gt;, and abbreviated variable names ¹​sched_dep_time,
#   ²​dep_delay, ³​arr_time, ⁴​sched_arr_time, ⁵​arr_delay</code></pre>
</div>
</div>
<p>정렬하고자 하는 열에 <code>desc()</code> 함수를 추가할 경우, 오름차순이 아닌 내림차순으로 정렬됩니다.</p>
</section>
<section id="join-데이터-합치기" class="level4">
<h4 class="anchored" data-anchor-id="join-데이터-합치기"><code>*_join()</code>: 데이터 합치기</h4>
<p>여러 테이블을 하나로 합치기 위해 <code>*_join()</code> 함수를 이용합니다. 합치는 방법은 그림 @ref(fig:joinimg2)과 표 @ref(tab:joindesc2) 같이 크게 네가지 종류가 있습니다.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/r_basic/rbasic_join.png" class="lightbox" title="*_ join() 함수의 종류" data-gallery="quarto-lightbox-gallery-26"><img src="images/r_basic/rbasic_join.png" class="img-fluid figure-img"></a></p>
<p></p><figcaption class="figure-caption">*_ join() 함수의 종류</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>join 함수의 종류</caption>
 <thead>
  <tr>
   <th style="text-align:center;"> 함수 </th>
   <th style="text-align:center;"> 내용 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:center;width: 4cm; "> inner_join() </td>
   <td style="text-align:center;width: 4cm; "> 교집합 </td>
  </tr>
  <tr>
   <td style="text-align:center;width: 4cm; "> full_join() </td>
   <td style="text-align:center;width: 4cm; "> 합집합 </td>
  </tr>
  <tr>
   <td style="text-align:center;width: 4cm; "> left_join() </td>
   <td style="text-align:center;width: 4cm; "> 좌측 기준 </td>
  </tr>
  <tr>
   <td style="text-align:center;width: 4cm; "> right_join() </td>
   <td style="text-align:center;width: 4cm; "> 우측 기준 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>다음 두개의 데이터 테이블을 이용하도록 합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb324"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a>flights2 <span class="ot">=</span> flights <span class="sc">%&gt;%</span> </span>
<span id="cb324-2"><a href="#cb324-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year<span class="sc">:</span>day, hour, tailnum, carrier)</span>
<span id="cb324-3"><a href="#cb324-3" aria-hidden="true" tabindex="-1"></a>flights2 <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
   year month   day  hour tailnum carrier
  &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  
1  2013     1     1     5 N14228  UA     
2  2013     1     1     5 N24211  UA     
3  2013     1     1     5 N619AA  AA     
4  2013     1     1     5 N804JB  B6     
5  2013     1     1     6 N668DN  DL     
6  2013     1     1     5 N39463  UA     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb326"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a>airlines <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  carrier name                    
  &lt;chr&gt;   &lt;chr&gt;                   
1 9E      Endeavor Air Inc.       
2 AA      American Airlines Inc.  
3 AS      Alaska Airlines Inc.    
4 B6      JetBlue Airways         
5 DL      Delta Air Lines Inc.    
6 EV      ExpressJet Airlines Inc.</code></pre>
</div>
</div>
<p>flights2 데이터에는 항공사 명의 약자인 carrier가 있으며, airlines 데이터는 해당 약자의 풀 네임이 적혀있습니다. <code>left_join()</code> 함수를 이용해 왼쪽 데이터프레임을 기준으로 데이터를 합치도록 하며, 두 데이터 모두 carrier 열이 있으므로 이를 기준으로 데이터가 합치도록 하겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb328"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a>flights2 <span class="sc">%&gt;%</span></span>
<span id="cb328-2"><a href="#cb328-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(airlines, <span class="at">by =</span> <span class="st">"carrier"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb328-3"><a href="#cb328-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
   year month   day  hour tailnum carrier name                  
  &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;                 
1  2013     1     1     5 N14228  UA      United Air Lines Inc. 
2  2013     1     1     5 N24211  UA      United Air Lines Inc. 
3  2013     1     1     5 N619AA  AA      American Airlines Inc.
4  2013     1     1     5 N804JB  B6      JetBlue Airways       
5  2013     1     1     6 N668DN  DL      Delta Air Lines Inc.  
6  2013     1     1     5 N39463  UA      United Air Lines Inc. </code></pre>
</div>
</div>
<p>flights2에서 모든 데이터를 가져오며, airlines의 name 열이 기존 테이블에 추가됩니다. join 구문에 대한 더욱 상세한 예제 및 애니메이션은 다음 주소를 참조하시기 바랍니다.</p>
<ul>
<li>https://github.com/gadenbuie/tidyexplain</li>
</ul>
</section>
<section id="mutate-새로운-열-생성하기" class="level4">
<h4 class="anchored" data-anchor-id="mutate-새로운-열-생성하기"><code>mutate()</code>: 새로운 열 생성하기</h4>
<p><code>mutate()</code> 함수를 사용해 기존 열끼리 계산을 하여 새로운 열을 생성할 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb330"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb330-1"><a href="#cb330-1" aria-hidden="true" tabindex="-1"></a>flights_sml <span class="ot">=</span> flights <span class="sc">%&gt;%</span></span>
<span id="cb330-2"><a href="#cb330-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb330-3"><a href="#cb330-3" aria-hidden="true" tabindex="-1"></a>    year<span class="sc">:</span>day, </span>
<span id="cb330-4"><a href="#cb330-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ends_with</span>(<span class="st">"delay"</span>), </span>
<span id="cb330-5"><a href="#cb330-5" aria-hidden="true" tabindex="-1"></a>    distance, </span>
<span id="cb330-6"><a href="#cb330-6" aria-hidden="true" tabindex="-1"></a>    air_time</span>
<span id="cb330-7"><a href="#cb330-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb330-8"><a href="#cb330-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb330-9"><a href="#cb330-9" aria-hidden="true" tabindex="-1"></a>flights_sml <span class="sc">%&gt;%</span></span>
<span id="cb330-10"><a href="#cb330-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb330-11"><a href="#cb330-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">gain =</span> dep_delay <span class="sc">-</span> arr_delay,</span>
<span id="cb330-12"><a href="#cb330-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">speed =</span> distance <span class="sc">/</span> air_time <span class="sc">*</span> <span class="dv">60</span></span>
<span id="cb330-13"><a href="#cb330-13" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb330-14"><a href="#cb330-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
   year month   day dep_delay arr_delay distance air_time  gain speed
  &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1  2013     1     1         2        11     1400      227    -9  370.
2  2013     1     1         4        20     1416      227   -16  374.
3  2013     1     1         2        33     1089      160   -31  408.
4  2013     1     1        -1       -18     1576      183    17  517.
5  2013     1     1        -6       -25      762      116    19  394.
6  2013     1     1        -4        12      719      150   -16  288.</code></pre>
</div>
</div>
<p>먼저 flights에서 일부 열을 선택하여 flights_sml에 저장합니다.그 후, <code>mutate()</code> 함수를 이용해 새로운 열을 만들어 줍니다. gain 열에는 dep_delay와 arr_delay의 차이가, speed 열에는 distance와 air_time 비에 60을 곱한 값이 새롭게 생성됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb332"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a>flights_sml <span class="sc">%&gt;%</span></span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb332-3"><a href="#cb332-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">'dep_delay'</span>, <span class="st">'arr_delay'</span>), <span class="sc">~</span> .x <span class="sc">*</span> <span class="dv">60</span>)</span>
<span id="cb332-4"><a href="#cb332-4" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb332-5"><a href="#cb332-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
   year month   day dep_delay arr_delay distance air_time
  &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1  2013     1     1       120       660     1400      227
2  2013     1     1       240      1200     1416      227
3  2013     1     1       120      1980     1089      160
4  2013     1     1       -60     -1080     1576      183
5  2013     1     1      -360     -1500      762      116
6  2013     1     1      -240       720      719      150</code></pre>
</div>
</div>
<p>동일한 함수를 한번에 여러행에 적용해야 할 때는 <code>mutate()</code> 함수 내에 <code>across()</code> 함수를 입력합니다. 위 예제에서는 dep_delay과 arr_delay열의 데이터에 60을 곱해주었습니다. <code>across()</code> 함수의 자세한 사용법은 다소 생소하고 어려울 수 있으므로 아래 페이지의 내용을 따라가며 익히시는게 좋습니다.</p>
<ul>
<li>https://dplyr.tidyverse.org/reference/across.html</li>
</ul>
</section>
</section>
</section>
<section id="ggplot을-이용한-데이터-시각화" class="level1">
<h1>ggplot을 이용한 데이터 시각화</h1>
<section id="그래픽-문법" class="level2">
<h2 class="anchored" data-anchor-id="그래픽-문법">그래픽 문법</h2>
<p>R에서 기본적으로 제공하는 <code>plot()</code> 함수를 이용해도 시각화가 충분히 가능합니다. 다음 사이트에는 기본 함수를 이용해 표현할 수 있는 다양한 그림이 나와 있습니다.</p>
<ul>
<li>http://www.sthda.com/english/wiki/r-base-graphs</li>
</ul>
<p>그러나 기본 함수를 이용하여 시각화를 할 경우 다음과 같은 문제가 있습니다.</p>
<ul>
<li>서로 다른 형태의 그림을 나타내기 위해 각각 다른 함수를 이용해야 함</li>
<li>표현할 수 있는 그림에 한계가 있음</li>
<li>원하는 형태로 꾸미기가 복잡함</li>
</ul>
<p>ggplot2 패키지는 데이터 과학자들에게 가장 많이 사랑받는 패키지 중 하나이며, <code>ggplot()</code> 함수를 사용하면 그림을 훨씬 아름답게 표현할 수 있으며 다양한 기능들을 매우 쉽게 사용할 수도 있습니다. 처음에는 함수의 문법이 다소 어색하지만, 해당 패키지의 근본이 되는 철학인 그래픽 문법(The Grammar of Graphics)를 이해하고 조금만 연습해본다면, 충분히 손쉽게 사용이 가능합니다.</p>
<p>그래픽 문법(Grammar of Graphics)은 릴랜드 윌킨스(Leland Wilkinson)의 책 The Grammar of Graphics(Wilkinson 2012)에서 따온 것으로써, 데이터를 어떻게 표현할 것인지에 대한 내용입니다.</p>
<blockquote class="blockquote">
<p>문법은 언어의 표현을 풍부하게 만든다. 단어만 있고 문법이 없는 언어가 있다면(단어 = 문장), 오직 단어의 갯수만큼만 생각을 표현할 수 있다. 문장 내에서 단어가 어떻게 구성되는 지를 규정함으로써, 문법은 언어의 범위를 확장한다.</p>
<p>— Leland Wilkinson, 《The Grammar of Graphics》 그래픽 문법에서 말하는 요소는 다음과 같습니다.</p>
</blockquote>
<ol type="1">
<li>Data: 시각화에 사용될 데이터</li>
<li>Aesthetics: 데이터를 나타내는 시각적인 요소(x축, y축, 사이즈, 색깔, 모양 등)</li>
<li>Geometrics: 데이터를 나타내는 도형</li>
<li>Facets: 하위 집합으로 분할하여 시각화</li>
<li>Statistics: 통계값을 표현</li>
<li>Coordinates: 데이터를 표현 할 이차원 좌표계</li>
<li>Theme: 그래프를 꾸밈</li>
</ol>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/r_basic/data_analysis_gg.png" class="lightbox" title="The Grammar of Graphics" data-gallery="quarto-lightbox-gallery-27"><img src="images/r_basic/data_analysis_gg.png" class="img-fluid figure-img"></a></p>
<p></p><figcaption class="figure-caption">The Grammar of Graphics</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>ggplot2 패키지의 앞글자가 gg인 것에서 알 수 있듯이, 해당 패키지는 그래픽 문법을 토대로 시각화를 표현하며, 전반적인 시각화의 순서는 그래픽 문법의 순서와 같습니다. ggplot2 패키지의 특징은 각 요소를 연결할 때 플러스(+) 기호를 사용한다는 점이며, 이는 그래픽 문법의 순서에 따라 요소들을 쌓아나간 후 최종적인 그래픽을 완성하는 패키지의 특성 때문입니다.</p>
<p>아래 사이트에는 R에서 ggplot2와 기타 패키지를 이용해 표현할 수 있는 그림이 정리되어 있습니다.</p>
<ul>
<li>https://www.r-graph-gallery.com/</li>
</ul>
</section>
<section id="데이터셋-다이아몬드" class="level2">
<h2 class="anchored" data-anchor-id="데이터셋-다이아몬드">데이터셋: 다이아몬드</h2>
<p>ggplot2 패키지에는 데이터분석 및 시각화 연습을 위한 각종 데이터셋이 있으며, 그 중에서도 diamonds 데이터셋이 널리 사용됩니다. 먼저 해당 데이터를 불러오도록 하겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb334"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb334-2"><a href="#cb334-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(diamonds)</span>
<span id="cb334-3"><a href="#cb334-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(diamonds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 10
  carat cut       color clarity depth table price     x     y     z
  &lt;dbl&gt; &lt;ord&gt;     &lt;ord&gt; &lt;ord&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1  0.23 Ideal     E     SI2      61.5    55   326  3.95  3.98  2.43
2  0.21 Premium   E     SI1      59.8    61   326  3.89  3.84  2.31
3  0.23 Good      E     VS1      56.9    65   327  4.05  4.07  2.31
4  0.29 Premium   I     VS2      62.4    58   334  4.2   4.23  2.63
5  0.31 Good      J     SI2      63.3    58   335  4.34  4.35  2.75
6  0.24 Very Good J     VVS2     62.8    57   336  3.94  3.96  2.48</code></pre>
</div>
</div>
<p>데이터의 각 변수는 다음과 같습니다.</p>
<ul>
<li>carat: 다이아몬드 무게</li>
<li>cut: 컷팅의 가치</li>
<li>color: 다이아몬드 색상</li>
<li>clarity: 깨끗한 정도</li>
<li>depth: 깊이 비율, z / mean(x, y)</li>
<li>table: 가장 넓은 부분의 너비 대비 다이아몬드 꼭대기의 너비</li>
<li>price: 가격</li>
<li>x: 길이</li>
<li>y: 너비</li>
<li>z: 깊이</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/r_basic/diamond_color.png" class="lightbox" title="color" data-gallery="quarto-lightbox-gallery-28"><img src="images/r_basic/diamond_color.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
<p></p><figcaption class="figure-caption">color</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/r_basic/diamond_clarity.png" class="lightbox" title="clarity" data-gallery="quarto-lightbox-gallery-29"><img src="images/r_basic/diamond_clarity.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
<p></p><figcaption class="figure-caption">clarity</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/r_basic/diamond_table.png" class="lightbox" title="table" data-gallery="quarto-lightbox-gallery-30"><img src="images/r_basic/diamond_table.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
<p></p><figcaption class="figure-caption">table</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>이 외에도 R에서 제공하는 다양한 데이터셋은 다음의 함수를 통해 확인할 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb336"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> [1] "band_instruments"       "band_instruments2"      "band_members"          
 [4] "starwars"               "storms"                 "diamonds"              
 [7] "economics"              "economics_long"         "faithfuld"             
[10] "luv_colours"            "midwest"                "mpg"                   
[13] "msleep"                 "presidential"           "seals"                 
[16] "txhousing"              "lakers"                 "airlines"              
[19] "airports"               "flights"                "planes"                
[22] "weather"                "fruit"                  "sentences"             
[25] "words"                  "billboard"              "construction"          
[28] "fish_encounters"        "population"             "relig_income"          
[31] "smiths"                 "table1"                 "table2"                
[34] "table3"                 "table4a"                "table4b"               
[37] "table5"                 "us_rent_income"         "who"                   
[40] "world_bank_pop"         "AirPassengers"          "BJsales"               
[43] "BJsales.lead (BJsales)" "BOD"                    "CO2"                   
[46] "ChickWeight"            "DNase"                  "EuStockMarkets"        
[49] "Formaldehyde"           "HairEyeColor"          </code></pre>
</div>
</div>
</section>
<section id="data-aesthetics-geometrics" class="level2">
<h2 class="anchored" data-anchor-id="data-aesthetics-geometrics">Data, Aesthetics, Geometrics</h2>
<p>그래픽 문법의 순서에 맞춰 그림을 쌓아나가보도록 하겠습니다. 먼저 Data는 사용될 데이터이며, Aesthetics는 <span class="math inline">\(x\)</span>축, <span class="math inline">\(y\)</span>축, 사이즈 등 시각적인 요소를 의미합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb338"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> diamonds, <span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">y =</span> price))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="r_basic_files/figure-html/unnamed-chunk-169-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-31"><img src="r_basic_files/figure-html/unnamed-chunk-169-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p><span class="math inline">\(x\)</span>축과 <span class="math inline">\(y\)</span>축에 우리가 매핑한 carat과 price가 표현되었지만, 어떠한 모양(Geometrics)으로 시각화를 할지 정의하지 않았으므로 빈 그림이 생성됩니다. 다음으로 Geometrics을 통해 데이터를 그림으로 표현해주도록 하겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb339"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> diamonds, <span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">y =</span> price)) <span class="sc">+</span></span>
<span id="cb339-2"><a href="#cb339-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="r_basic_files/figure-html/unnamed-chunk-170-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-32"><img src="r_basic_files/figure-html/unnamed-chunk-170-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>사전에 정의된 Data와 Aesthetics 위에, 플러스(+) 기호를 통해 <code>geom_point()</code> 함수를 입력하여 산점도가 표현되었습니다. geom은 Geometrics의 약자이며, 이처럼 <code>geom_*()</code> 함수를 통해 원하는 형태로 시각화를 할 수 있습니다.</p>
<p>일반적으로 Data는 <code>ggplot()</code> 함수 내에서 정의하기 보다는, dplyr 패키지의 함수들을 이용하여 데이터를 가공한 후 파이프 오퍼레이터(<code>%&gt;%</code>)를 통해 연결합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb340"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb340-2"><a href="#cb340-2" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span></span>
<span id="cb340-3"><a href="#cb340-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">y =</span> price)) <span class="sc">+</span></span>
<span id="cb340-4"><a href="#cb340-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> cut, <span class="at">shape =</span> cut))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using shapes for an ordinal variable is not advised</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="r_basic_files/figure-html/unnamed-chunk-171-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-33"><img src="r_basic_files/figure-html/unnamed-chunk-171-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>diamonds 데이터를 파이프 오퍼레이터로 이을 경우 그대로 시각화가 가능하며, <code>ggplot()</code> 함수 내에 데이터를 입력하지 않아도 됩니다.</p>
<p><code>geom_point()</code> 내부에서 aes()를 통해 점의 색깔을 매핑해줄 수 있습니다. <code>color = cut, shape = cut</code>을 지정하여 cut에 따라 점의 색깔과 형태를 다르게 표현하였습니다. 이 외에도 size 등을 통해 그룹별로 그래프를 각각 다르게 표현할 수 있습니다.</p>
</section>
<section id="facets" class="level2">
<h2 class="anchored" data-anchor-id="facets">Facets</h2>
<p>Facets은 여러 집합을 하나의 그림에 표현하기 보다 하위 집합으로 나누어 시각화하는 요소입니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb342"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb342-1"><a href="#cb342-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span></span>
<span id="cb342-2"><a href="#cb342-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">y =</span> price)) <span class="sc">+</span></span>
<span id="cb342-3"><a href="#cb342-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb342-4"><a href="#cb342-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> cut)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="r_basic_files/figure-html/unnamed-chunk-172-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-34"><img src="r_basic_files/figure-html/unnamed-chunk-172-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p><code>facet_grid()</code> 혹은 <code>facet_wrap()</code> 함수를 통해 그림을 분할할 수 있습니다. 물결 표시(~)를 통해 하위 집합으로 나누고자 하는 변수를 선택할 수 있으며, 위 예제에서는 cut에 따라 각기 다른 그림으로 표현되었습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb343"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span></span>
<span id="cb343-2"><a href="#cb343-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">y =</span> price)) <span class="sc">+</span></span>
<span id="cb343-3"><a href="#cb343-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb343-4"><a href="#cb343-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(color <span class="sc">~</span> cut)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="r_basic_files/figure-html/unnamed-chunk-173-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-35"><img src="r_basic_files/figure-html/unnamed-chunk-173-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>color를 추가해 <code>facet_grid(color ~ cut)</code>를 입력하면 가로는 color, 세로는 cut으로 그림이 나누어집니다.</p>
</section>
<section id="statistics" class="level2">
<h2 class="anchored" data-anchor-id="statistics">Statistics</h2>
<p>Statistics는 통계값을 나타내는 요소입니다. 실무에서는 dplyr 패키지를 이용해 데이터의 통계값을 계산한 후 이를 그림으로 나타냅니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb344"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb344-2"><a href="#cb344-2" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span></span>
<span id="cb344-3"><a href="#cb344-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(color) <span class="sc">%&gt;%</span></span>
<span id="cb344-4"><a href="#cb344-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">carat =</span> <span class="fu">mean</span>(carat)) <span class="sc">%&gt;%</span></span>
<span id="cb344-5"><a href="#cb344-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> color, <span class="at">y =</span> carat)) <span class="sc">+</span></span>
<span id="cb344-6"><a href="#cb344-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="r_basic_files/figure-html/unnamed-chunk-174-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-36"><img src="r_basic_files/figure-html/unnamed-chunk-174-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>그룹 별 carat의 평균을 계산한 후 시각화를 하였습니다.</p>
</section>
<section id="coordinates" class="level2">
<h2 class="anchored" data-anchor-id="coordinates">Coordinates</h2>
<p>Coordinates는 좌표를 의미합니다. ggplot2에서는 `coord_*() 함수를 이용하여 <span class="math inline">\(x\)</span>축 혹은 <span class="math inline">\(y\)</span>축 정보를 변형할 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb345"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span></span>
<span id="cb345-2"><a href="#cb345-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">y =</span> price)) <span class="sc">+</span></span>
<span id="cb345-3"><a href="#cb345-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> cut)) <span class="sc">+</span></span>
<span id="cb345-4"><a href="#cb345-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="r_basic_files/figure-html/unnamed-chunk-175-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-37"><img src="r_basic_files/figure-html/unnamed-chunk-175-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p><code>coord_cartesian()</code> 함수를 통해 <span class="math inline">\(x\)</span>축과 <span class="math inline">\(y\)</span>축 범위를 지정해 줄 수 있습니다. xlim과 ylim 내부에 범위의 최소 및 최댓값을 지정해주면, 해당 범위의 데이터만을 보여줍니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb346"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span></span>
<span id="cb346-2"><a href="#cb346-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">y =</span> price)) <span class="sc">+</span></span>
<span id="cb346-3"><a href="#cb346-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">group =</span> cut))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="r_basic_files/figure-html/unnamed-chunk-176-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-38"><img src="r_basic_files/figure-html/unnamed-chunk-176-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb347"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span></span>
<span id="cb347-2"><a href="#cb347-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">y =</span> price)) <span class="sc">+</span></span>
<span id="cb347-3"><a href="#cb347-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">group =</span> cut)) <span class="sc">+</span></span>
<span id="cb347-4"><a href="#cb347-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="r_basic_files/figure-html/unnamed-chunk-176-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-39"><img src="r_basic_files/figure-html/unnamed-chunk-176-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p><code>coord_flip()</code> 함수는 <span class="math inline">\(x\)</span>축과 <span class="math inline">\(y\)</span>축을 뒤집어 표현합니다. 위의 그림은 <code>ggplot()</code> 함수의 aes 내부에서 <span class="math inline">\(x\)</span>축은 carat을, <span class="math inline">\(y\)</span>축은 price를 지정해 주었지만, 아래 그림에서는 <code>coord_flip()</code> 함수를 통해 각 축이 서로 바뀌었습니다.</p>
</section>
<section id="theme" class="level2">
<h2 class="anchored" data-anchor-id="theme">Theme</h2>
<p>Theme은 그림의 제목, 축 제목, 축 단위, 범례, 디자인 등 그림을 꾸며주는 역할을 담당합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb348"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span></span>
<span id="cb348-2"><a href="#cb348-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">y =</span> price)) <span class="sc">+</span></span>
<span id="cb348-3"><a href="#cb348-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> cut)) <span class="sc">+</span></span>
<span id="cb348-4"><a href="#cb348-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb348-5"><a href="#cb348-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Relation between Carat &amp; Price'</span>,</span>
<span id="cb348-6"><a href="#cb348-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">'Carat'</span>, <span class="at">y =</span> <span class="st">'Price'</span>) <span class="sc">+</span></span>
<span id="cb348-7"><a href="#cb348-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'bottom'</span>,</span>
<span id="cb348-8"><a href="#cb348-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb348-9"><a href="#cb348-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb348-10"><a href="#cb348-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb348-11"><a href="#cb348-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb348-12"><a href="#cb348-12" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">+</span></span>
<span id="cb348-13"><a href="#cb348-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb348-14"><a href="#cb348-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="cf">function</span>(x) {</span>
<span id="cb348-15"><a href="#cb348-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">'$'</span>, </span>
<span id="cb348-16"><a href="#cb348-16" aria-hidden="true" tabindex="-1"></a>             <span class="fu">format</span>(x, <span class="at">big.mark =</span> <span class="st">','</span>))</span>
<span id="cb348-17"><a href="#cb348-17" aria-hidden="true" tabindex="-1"></a>    })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="r_basic_files/figure-html/unnamed-chunk-177-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-40"><img src="r_basic_files/figure-html/unnamed-chunk-177-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p><code>geom_point()</code> 함수 이후 Theme에 해당하는 부분은 다음과 같습니다.</p>
<ol type="1">
<li><code>theme_bw()</code> 함수를 통해 배경을 흰색으로 설정합니다.</li>
<li><code>labs()</code> 함수를 통해 그래프의 제목 및 <span class="math inline">\(x\)</span>축, <span class="math inline">\(y\)</span>축 제목을 변경합니다.</li>
<li><code>theme()</code> 함수 내 legend.position을 통해 범례를 하단으로 이동합니다.</li>
<li><code>theme()</code> 함수 내 panel.grid를 통해 격자를 제거합니다.</li>
<li><code>scale_y_continuous()</code> 함수를 통해 <span class="math inline">\(y\)</span>축에서 천원 단위로 콤마(,)를 붙여주며, 이를 달러($) 표시와 합쳐줍니다.</li>
</ol>
<p>이 외에도 각종 테마를 적용해 얼마든지 원하는 그림을 꾸밀 수 있습니다. R에서 적용가능한 그래프의 테마는 다음과 같습니다.</p>
<ul>
<li>https://ggplot2.tidyverse.org/reference/ggtheme.html</li>
</ul>
</section>
<section id="각종-팁" class="level2">
<h2 class="anchored" data-anchor-id="각종-팁">각종 팁</h2>
<p>원하는 형태로 그래프를 가공하고자 할 경우, 구글에 검색을 하면 얼마든지 원하는 답을 얻을 수 있습니다. 만약 범례를 지우고 싶을 경우, 구글에서 ’remove legend ggplot’을 검색하도록 합니다.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/r_basic/remove_legend.png" class="lightbox" title="범례 지우기" data-gallery="quarto-lightbox-gallery-41"><img src="images/r_basic/remove_legend.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
<p></p><figcaption class="figure-caption">범례 지우기</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>이를 통해 우리가 원하는 답을 쉽게 얻을 수 있습니다.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/r_basic/remove_legend2.png" class="lightbox" title="범례를 지우는 코드" data-gallery="quarto-lightbox-gallery-42"><img src="images/r_basic/remove_legend2.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
<p></p><figcaption class="figure-caption">범례를 지우는 코드</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>또한 ggplot2 패키지 만으로도 나타낼 수 없는 그래프는 다양한 확장 패키지들을 통해 얼마든지 나타낼 수 있습니다.</p>
<ul>
<li>https://exts.ggplot2.tidyverse.org/gallery/</li>
</ul>
<p>해당 패키지에 대한 더욱 자세한 설명은 패키지들의 책을 살펴보시기 바랍니다. 해당 책은 온라인에서 무료로 확인할 수 있습니다.</p>
<ul>
<li>https://ggplot2-book.org/</li>
</ul>
</section>
</section>
<section id="실제-금융데이터-분석하기" class="level1">
<h1>실제 금융데이터 분석하기</h1>
<p>데이터 분석 및 시각화 실습을 위헤 국내 상장종목 티커 리스트 및 WICS 기준 섹터 지표를 다운로드 합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb349"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(<span class="st">'https://raw.githubusercontent.com/hyunyulhenry/dmmr_quant/master/KOR_sector.csv'</span>, <span class="st">'KOR_sector.csv'</span>)</span>
<span id="cb349-2"><a href="#cb349-2" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(<span class="st">'https://raw.githubusercontent.com/hyunyulhenry/dmmr_quant/master/KOR_ticker.csv'</span>, <span class="st">'KOR_ticker.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>해당 데이터를 불러옵니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb350"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb350-2"><a href="#cb350-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb350-3"><a href="#cb350-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-4"><a href="#cb350-4" aria-hidden="true" tabindex="-1"></a>KOR_ticker <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">'KOR_ticker.csv'</span>, <span class="at">fileEncoding =</span> <span class="st">'EUC-KR'</span>)</span>
<span id="cb350-5"><a href="#cb350-5" aria-hidden="true" tabindex="-1"></a>KOR_sector <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">'KOR_sector.csv'</span>, <span class="at">fileEncoding =</span> <span class="st">'EUC-KR'</span>)</span>
<span id="cb350-6"><a href="#cb350-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-7"><a href="#cb350-7" aria-hidden="true" tabindex="-1"></a>KOR_ticker <span class="ot">=</span> KOR_ticker <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(종목코드 <span class="ot">=</span> <span class="fu">str_pad</span>(종목코드, <span class="dv">6</span>,<span class="st">'left'</span>, <span class="dv">0</span>))</span>
<span id="cb350-8"><a href="#cb350-8" aria-hidden="true" tabindex="-1"></a>KOR_sector <span class="ot">=</span> KOR_sector <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">CMP_CD =</span> <span class="fu">str_pad</span>(CMP_CD, <span class="dv">6</span>,<span class="st">'left'</span>, <span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>각 파일을 불러온 후 티커에 해당하는 종목코드와 CMP_CD 열을 6자리 숫자로 만들어줍니다.</p>
<section id="join" class="level2">
<h2 class="anchored" data-anchor-id="join"><code>*_join()</code></h2>
<p>먼저 두 테이블을 하나로 합쳐줍니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb351"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a>data_market <span class="ot">=</span> <span class="fu">left_join</span>(KOR_ticker, KOR_sector,</span>
<span id="cb351-2"><a href="#cb351-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'종목코드'</span> <span class="ot">=</span> <span class="st">'CMP_CD'</span>,</span>
<span id="cb351-3"><a href="#cb351-3" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'종목명'</span> <span class="ot">=</span> <span class="st">'CMP_KOR'</span>)) </span>
<span id="cb351-4"><a href="#cb351-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb351-5"><a href="#cb351-5" aria-hidden="true" tabindex="-1"></a>data_market <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  종목코드           종목명   종가   대비 등락률 시장구분   업종명    시가총액
1   005930         삼성전자  70400  -1100  -1.54    KOSPI 전기전자 4.20273e+14
2   000660       SK하이닉스 105500  -2000  -1.86    KOSPI 전기전자 7.68042e+13
3   035420            NAVER 402500  -7500  -1.83    KOSPI 서비스업 6.61160e+13
4   207940 삼성바이오로직스 874000      0   0.00    KOSPI   의약품 5.78000e+13
5   035720           카카오 124500  -3500  -2.73    KOSPI 서비스업 5.54475e+13
6   051910           LG화학 784000 -47000  -5.66    KOSPI     화학 5.53444e+13
   EPS    PER    BPS   PBR 주당배당금 배당수익률 IDX_CD              IDX_NM_KOR
1 3841  18.33  39406  1.79       2994       4.25    G45                 WICS IT
2 6952  15.18  71275  1.48       1170       1.11    G45                 WICS IT
3 6877  58.53  44850  8.97        402       0.10    G50 WICS 커뮤니케이션서비스
4 3642 239.98  69505 12.57          0       0.00    G35           WICS 건강관리
5  369 337.40  14286  8.71         30       0.02    G50 WICS 커뮤니케이션서비스
6 6666 117.61 230440  3.40      10000       1.28    G15               WICS 소재
  ALL_MKT_VAL   MKT_VAL   WGT S_WGT CAL_WGT SEC_CD         SEC_NM_KOR SEQ TOP60
1   551957421 315204519 57.11 57.11       1    G45                 IT   1     2
2   551957421  56835145 10.30 67.40       1    G45                 IT   2     2
3   180662521  51570493 28.55 28.55       1    G50 커뮤니케이션서비스   1     4
4   136785726  14457053 10.57 26.66       1    G35           건강관리   2    27
5   180662521  38258764 21.18 49.72       1    G50 커뮤니케이션서비스   2     4
6   122898119  35420414 28.82 28.82       1    G15               소재   1     8
  APT_SHR_CNT
1  4477336913
2   538721750
3   128125448
4    16541250
5   307299311
6    45179100</code></pre>
</div>
</div>
<p><code>left_join()</code> 함수를 이용해 KOR_ticker와 KOR_sector 데이터를 합쳐줍니다. by 인자는 데이터를 합치는 기준점을 의미하며, x 데이터(KOR_ticker)의 종목코드와 y 데이터(KOR_sector)의 CMP_CD는 같음을, x 데이터의 종목명과 y 데이터의 CMP_KOR는 같음을 정의합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb353"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a>data_market <span class="ot">=</span> data_market <span class="sc">%&gt;%</span> <span class="fu">as_tibble</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>데이터 분석시에는 데이터프레임 보다는 티블 형태가 더욱 깔끔하므로 형태를 변경해줍니다.</p>
</section>
<section id="glimpse" class="level2">
<h2 class="anchored" data-anchor-id="glimpse"><code>glimpse()</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb354"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(data_market)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 2,237
Columns: 26
$ 종목코드    &lt;chr&gt; "005930", "000660", "035420", "207940", "035720", "051910"…
$ 종목명      &lt;chr&gt; "삼성전자", "SK하이닉스", "NAVER", "삼성바이오로직스", "카…
$ 종가        &lt;dbl&gt; 70400, 105500, 402500, 874000, 124500, 784000, 732000, 208…
$ 대비        &lt;int&gt; -1100, -2000, -7500, 0, -3500, -47000, 1000, -1500, -1000,…
$ 등락률      &lt;dbl&gt; -1.54, -1.86, -1.83, 0.00, -2.73, -5.66, 0.14, -0.71, -1.1…
$ 시장구분    &lt;chr&gt; "KOSPI", "KOSPI", "KOSPI", "KOSPI", "KOSPI", "KOSPI", "KOS…
$ 업종명      &lt;chr&gt; "전기전자", "전기전자", "서비스업", "의약품", "서비스업", …
$ 시가총액    &lt;dbl&gt; 4.20273e+14, 7.68042e+13, 6.61160e+13, 5.78000e+13, 5.5447…
$ EPS         &lt;int&gt; 3841, 6952, 6877, 3642, 369, 6666, 8593, 5454, 3710, 3756,…
$ PER         &lt;dbl&gt; 18.33, 15.18, 58.53, 239.98, 337.40, 117.61, 85.19, 38.23,…
$ BPS         &lt;int&gt; 39406, 71275, 44850, 69505, 14286, 230440, 184387, 250888,…
$ PBR         &lt;dbl&gt; 1.79, 1.48, 8.97, 12.57, 8.71, 3.40, 3.97, 0.83, 1.15, 8.6…
$ 주당배당금  &lt;int&gt; 2994, 1170, 402, 0, 30, 10000, 1000, 3000, 1000, 0, 0, 800…
$ 배당수익률  &lt;dbl&gt; 4.25, 1.11, 0.10, 0.00, 0.02, 1.28, 0.14, 1.44, 1.18, 0.00…
$ IDX_CD      &lt;chr&gt; "G45", "G45", "G50", "G35", "G50", "G15", "G45", "G25", "G…
$ IDX_NM_KOR  &lt;chr&gt; "WICS IT", "WICS IT", "WICS 커뮤니케이션서비스", "WICS 건…
$ ALL_MKT_VAL &lt;int&gt; 551957421, 551957421, 180662521, 136785726, 180662521, 122…
$ MKT_VAL     &lt;int&gt; 315204519, 56835145, 51570493, 14457053, 38258764, 3542041…
$ WGT         &lt;dbl&gt; 57.11, 10.30, 28.55, 10.57, 21.18, 28.82, 6.75, 18.14, 13.…
$ S_WGT       &lt;dbl&gt; 57.11, 67.40, 28.55, 26.66, 49.72, 28.82, 74.15, 18.14, 31…
$ CAL_WGT     &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, NA, 1, 1, 1, 1, 1, 1, …
$ SEC_CD      &lt;chr&gt; "G45", "G45", "G50", "G35", "G50", "G15", "G45", "G25", "G…
$ SEC_NM_KOR  &lt;chr&gt; "IT", "IT", "커뮤니케이션서비스", "건강관리", "커뮤니케이…
$ SEQ         &lt;int&gt; 1, 2, 1, 2, 2, 1, 3, 1, 2, 1, 4, 2, NA, 3, 3, 1, 1, 5, 1, …
$ TOP60       &lt;int&gt; 2, 2, 4, 27, 4, 8, 2, 9, 9, 27, 7, 8, NA, 9, 4, 7, 2, 4, 2…
$ APT_SHR_CNT &lt;dbl&gt; 4477336913, 538721750, 128125448, 16541250, 307299311, 451…</code></pre>
</div>
</div>
<p><code>glimpse()</code> 함수는 데이터 내용, 구조, 형식을 확인하는 함수입니다. 기본 함수인 <code>str()</code>과 그 역할은 비슷하지만, tidy 형태로 결과물이 훨씬 깔끔하게 출력됩니다. 총 관측값 및 열의 개수, 각 열의 이름과 데이터 형식, 앞부분 데이터를 확인할 수 있습니다.</p>
</section>
<section id="rename-열-이름-바꾸기" class="level2">
<h2 class="anchored" data-anchor-id="rename-열-이름-바꾸기"><code>rename()</code>: 열 이름 바꾸기</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb356"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb356-1"><a href="#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(data_market)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "종목코드"    "종목명"      "종가"        "대비"        "등락률"     
 [6] "시장구분"    "업종명"      "시가총액"    "EPS"         "PER"        
[11] "BPS"         "PBR"         "주당배당금"  "배당수익률"  "IDX_CD"     
[16] "IDX_NM_KOR"  "ALL_MKT_VAL" "MKT_VAL"     "WGT"         "S_WGT"      
[21] "CAL_WGT"     "SEC_CD"      "SEC_NM_KOR"  "SEQ"         "TOP60"      
[26] "APT_SHR_CNT"</code></pre>
</div>
</div>
<p>열 이름 중 ’배당수익률’이 있습니다. 해당 이름을 변경해주도록 하겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb358"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb358-1"><a href="#cb358-1" aria-hidden="true" tabindex="-1"></a>data_market <span class="ot">=</span> data_market <span class="sc">%&gt;%</span></span>
<span id="cb358-2"><a href="#cb358-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">배당수익률(%)</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">배당수익률</span><span class="st">`</span>)</span>
<span id="cb358-3"><a href="#cb358-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-4"><a href="#cb358-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(data_market)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "종목코드"      "종목명"        "종가"          "대비"         
 [5] "등락률"        "시장구분"      "업종명"        "시가총액"     
 [9] "EPS"           "PER"           "BPS"           "PBR"          
[13] "주당배당금"    "배당수익률(%)" "IDX_CD"        "IDX_NM_KOR"   
[17] "ALL_MKT_VAL"   "MKT_VAL"       "WGT"           "S_WGT"        
[21] "CAL_WGT"       "SEC_CD"        "SEC_NM_KOR"    "SEQ"          
[25] "TOP60"         "APT_SHR_CNT"  </code></pre>
</div>
</div>
<p><code>rename()</code> 함수는 열 이름을 바꾸는 함수로서, <code>rename(tbl, new_name = old_name)</code> 형태로 입력합니다. 위의 경우 배당수익률 열 이름이 배당수익률(%)로 변경되었습니다.</p>
</section>
<section id="distinct" class="level2">
<h2 class="anchored" data-anchor-id="distinct"><code>distinct()</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb360"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb360-1"><a href="#cb360-1" aria-hidden="true" tabindex="-1"></a>data_market <span class="sc">%&gt;%</span></span>
<span id="cb360-2"><a href="#cb360-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(SEC_NM_KOR) <span class="sc">%&gt;%</span> <span class="fu">pull</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "IT"                 "커뮤니케이션서비스" "건강관리"          
 [4] "소재"               "경기관련소비재"     "금융"              
 [7] NA                   "에너지"             "산업재"            
[10] "유틸리티"           "필수소비재"        </code></pre>
</div>
</div>
<p><code>distinct()</code> 함수는 고유한 값을 반환하며, 기본 함수 중 <code>unique()</code>와 동일한 기능을 합니다. 데이터의 섹터 정보를 확인해보면, WICS 기준 10개 섹터 및 섹터 정보가 없는 종목인 NA 값이 있습니다. 또한 <code>pull()</code> 함수는 열을 벡터로 치환해줍니다.</p>
</section>
<section id="select" class="level2">
<h2 class="anchored" data-anchor-id="select"><code>select()</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb362"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true" tabindex="-1"></a>data_market <span class="sc">%&gt;%</span></span>
<span id="cb362-2"><a href="#cb362-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(종목명) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 1
  종목명          
  &lt;chr&gt;           
1 삼성전자        
2 SK하이닉스      
3 NAVER           
4 삼성바이오로직스
5 카카오          
6 LG화학          </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb364"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true" tabindex="-1"></a>data_market <span class="sc">%&gt;%</span></span>
<span id="cb364-2"><a href="#cb364-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(종목명, PBR, SEC_NM_KOR) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  종목명             PBR SEC_NM_KOR        
  &lt;chr&gt;            &lt;dbl&gt; &lt;chr&gt;             
1 삼성전자          1.79 IT                
2 SK하이닉스        1.48 IT                
3 NAVER             8.97 커뮤니케이션서비스
4 삼성바이오로직스 12.6  건강관리          
5 카카오            8.71 커뮤니케이션서비스
6 LG화학            3.4  소재              </code></pre>
</div>
</div>
<p><code>select()</code> 함수는 원하는 열을 선택해주는 함수이며, 원하는 열 이름을 입력하면 됩니다. 하나의 열뿐만 아니라 다수의 열을 입력하면 해당 열들이 선택됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb366"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true" tabindex="-1"></a>data_market <span class="sc">%&gt;%</span></span>
<span id="cb366-2"><a href="#cb366-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">'시'</span>)) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  시장구분 시가총액
  &lt;chr&gt;       &lt;dbl&gt;
1 KOSPI     4.20e14
2 KOSPI     7.68e13
3 KOSPI     6.61e13
4 KOSPI     5.78e13
5 KOSPI     5.54e13
6 KOSPI     5.53e13</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb368"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb368-1"><a href="#cb368-1" aria-hidden="true" tabindex="-1"></a>data_market <span class="sc">%&gt;%</span></span>
<span id="cb368-2"><a href="#cb368-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">'R'</span>)) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
    PER   PBR IDX_NM_KOR              SEC_NM_KOR        
  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;                   &lt;chr&gt;             
1  18.3  1.79 WICS IT                 IT                
2  15.2  1.48 WICS IT                 IT                
3  58.5  8.97 WICS 커뮤니케이션서비스 커뮤니케이션서비스
4 240.  12.6  WICS 건강관리           건강관리          
5 337.   8.71 WICS 커뮤니케이션서비스 커뮤니케이션서비스
6 118.   3.4  WICS 소재               소재              </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb370"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true" tabindex="-1"></a>data_market <span class="sc">%&gt;%</span></span>
<span id="cb370-2"><a href="#cb370-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">'가'</span>)) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
    종가 시가총액
   &lt;dbl&gt;    &lt;dbl&gt;
1  70400  4.20e14
2 105500  7.68e13
3 402500  6.61e13
4 874000  5.78e13
5 124500  5.54e13
6 784000  5.53e13</code></pre>
</div>
</div>
<p>해당 함수는 다양한 응용 기능도 제공합니다.<code>starts_with()</code>는 특정 문자로 시작하는 열들을 선택하고, <code>ends_with()</code>는 특정 문자로 끝나는 열들을 선택하며, <code>contains()</code>는 특정 문자가 포함되는 열들을 선택합니다.</p>
</section>
<section id="mutate" class="level2">
<h2 class="anchored" data-anchor-id="mutate"><code>mutate()</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb372"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true" tabindex="-1"></a>data_market <span class="ot">=</span> data_market <span class="sc">%&gt;%</span></span>
<span id="cb372-2"><a href="#cb372-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PBR =</span> <span class="fu">as.numeric</span>(PBR),</span>
<span id="cb372-3"><a href="#cb372-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">PER =</span> <span class="fu">as.numeric</span>(PER),</span>
<span id="cb372-4"><a href="#cb372-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">ROE =</span> PBR <span class="sc">/</span> PER,</span>
<span id="cb372-5"><a href="#cb372-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">ROE =</span> <span class="fu">round</span>(ROE, <span class="dv">4</span>),</span>
<span id="cb372-6"><a href="#cb372-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">size =</span> <span class="fu">ifelse</span>(시가총액 <span class="sc">&gt;=</span></span>
<span id="cb372-7"><a href="#cb372-7" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">median</span>(시가총액, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb372-8"><a href="#cb372-8" aria-hidden="true" tabindex="-1"></a>                       <span class="st">'big'</span>, <span class="st">'small'</span>)</span>
<span id="cb372-9"><a href="#cb372-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb372-10"><a href="#cb372-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-11"><a href="#cb372-11" aria-hidden="true" tabindex="-1"></a>data_market <span class="sc">%&gt;%</span></span>
<span id="cb372-12"><a href="#cb372-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(종목명, ROE, size) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  종목명              ROE size 
  &lt;chr&gt;             &lt;dbl&gt; &lt;chr&gt;
1 삼성전자         0.0977 big  
2 SK하이닉스       0.0975 big  
3 NAVER            0.153  big  
4 삼성바이오로직스 0.0524 big  
5 카카오           0.0258 big  
6 LG화학           0.0289 big  </code></pre>
</div>
</div>
<p><code>mutate()</code> 함수는 원하는 형태로 열을 생성하거나 변형하는 함수입니다. 위 예제에 서는 먼저 PBR과 PER 열을 <code>as.numeric()</code> 함수를 통해 숫자형으로 변경한 후 PBR을 PER로 나눈 값을 ROE 열에 생성합니다. 그 후 <code>round()</code> 함수를 통해 ROE 값을 반올림하며, <code>ifelse()</code> 함수를 통해 시가총액의 중앙값보다 큰 기업은 big, 아닐 경우 small임을 size 열에 저장합니다.</p>
<p>이 외에도 <code>mutate()</code> 함수 내에 <code>across()</code> 함수를 사용해 각 상황에 맞게 데이터를 변형할 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb374"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb374-1"><a href="#cb374-1" aria-hidden="true" tabindex="-1"></a>data_market <span class="sc">%&gt;%</span></span>
<span id="cb374-2"><a href="#cb374-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span>.x <span class="sc">*</span> <span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,237 × 28
   종목코드 종목명        종가   대비 등락률 시장…¹ 업종명   시가…²    EPS   PER
   &lt;chr&gt;    &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
 1 005930   삼성전자    7.04e6 -1.1e5   -154 KOSPI  전기전… 4.20e16 384100  1833
 2 000660   SK하이닉스  1.06e7 -2  e5   -186 KOSPI  전기전… 7.68e15 695200  1518
 3 035420   NAVER       4.03e7 -7.5e5   -183 KOSPI  서비스… 6.61e15 687700  5853
 4 207940   삼성바이오… 8.74e7  0          0 KOSPI  의약품  5.78e15 364200 23998
 5 035720   카카오      1.25e7 -3.5e5   -273 KOSPI  서비스… 5.54e15  36900 33740
 6 051910   LG화학      7.84e7 -4.7e6   -566 KOSPI  화학    5.53e15 666600 11761
 7 006400   삼성SDI     7.32e7  1  e5     14 KOSPI  전기전… 5.03e15 859300  8519
 8 005380   현대차      2.08e7 -1.5e5    -71 KOSPI  운수장… 4.45e15 545400  3823
 9 000270   기아        8.5 e6 -1  e5   -116 KOSPI  운수장… 3.45e15 371000  2291
10 068270   셀트리온    2.1 e7  3.5e5    169 KOSPI  의약품  2.90e15 375600  5591
# … with 2,227 more rows, 18 more variables: BPS &lt;dbl&gt;, PBR &lt;dbl&gt;,
#   주당배당금 &lt;dbl&gt;, `배당수익률(%)` &lt;dbl&gt;, IDX_CD &lt;chr&gt;, IDX_NM_KOR &lt;chr&gt;,
#   ALL_MKT_VAL &lt;dbl&gt;, MKT_VAL &lt;dbl&gt;, WGT &lt;dbl&gt;, S_WGT &lt;dbl&gt;, CAL_WGT &lt;dbl&gt;,
#   SEC_CD &lt;chr&gt;, SEC_NM_KOR &lt;chr&gt;, SEQ &lt;dbl&gt;, TOP60 &lt;dbl&gt;, APT_SHR_CNT &lt;dbl&gt;,
#   ROE &lt;dbl&gt;, size &lt;chr&gt;, and abbreviated variable names ¹​시장구분, ²​시가총액</code></pre>
</div>
</div>
<p><code>across(where(is.numeric)</code>를 통해 숫자에 해당하는 열만 선택하고, 해당 값들에 100을 곱합니다.</p>
</section>
<section id="filter" class="level2">
<h2 class="anchored" data-anchor-id="filter"><code>filter()</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb376"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb376-1"><a href="#cb376-1" aria-hidden="true" tabindex="-1"></a>data_market <span class="sc">%&gt;%</span></span>
<span id="cb376-2"><a href="#cb376-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(종목명, PBR) <span class="sc">%&gt;%</span></span>
<span id="cb376-3"><a href="#cb376-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PBR <span class="sc">&lt;</span> <span class="dv">1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 612 × 2
   종목명         PBR
   &lt;chr&gt;        &lt;dbl&gt;
 1 현대차        0.83
 2 POSCO         0.59
 3 현대모비스    0.72
 4 KB금융        0.54
 5 삼성물산      0.73
 6 신한지주      0.46
 7 LG            0.8 
 8 한국전력      0.21
 9 삼성생명      0.32
10 하나금융지주  0.43
# … with 602 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb378"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb378-1"><a href="#cb378-1" aria-hidden="true" tabindex="-1"></a>data_market <span class="sc">%&gt;%</span></span>
<span id="cb378-2"><a href="#cb378-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(종목명, PBR, PER, ROE) <span class="sc">%&gt;%</span></span>
<span id="cb378-3"><a href="#cb378-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PBR <span class="sc">&lt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> PER <span class="sc">&lt;</span> <span class="dv">20</span> <span class="sc">&amp;</span> ROE <span class="sc">&gt;</span> <span class="fl">0.1</span> ) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  종목명         PBR   PER   ROE
  &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 미래에셋증권  0.75  7.21 0.104
2 한국금융지주  0.96  5.91 0.162
3 DB손해보험    0.64  6.36 0.101
4 메리츠증권    0.76  5.43 0.14 
5 KCC           0.58  4.39 0.132
6 키움증권      0.94  3.48 0.270</code></pre>
</div>
</div>
<p><code>filter()</code> 함수는 조건을 충족하는 부분의 데이터를 반환하는 함수입니다. 첫 번째 예제와 같이 PBR이 1 미만인 단일 조건을 입력할 수도 있으며, 두 번째 예제와 같이 PBR 1 미만, PER 20 미만, ROE 0.1 초과 등 복수 조건을 입력할 수도 있습니다.</p>
</section>
<section id="summarize" class="level2">
<h2 class="anchored" data-anchor-id="summarize"><code>summarize()</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb380"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb380-1"><a href="#cb380-1" aria-hidden="true" tabindex="-1"></a>data_market <span class="sc">%&gt;%</span></span>
<span id="cb380-2"><a href="#cb380-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">PBR_max =</span> <span class="fu">max</span>(PBR, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb380-3"><a href="#cb380-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">PBR_min =</span> <span class="fu">min</span>(PBR, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  PBR_max PBR_min
    &lt;dbl&gt;   &lt;dbl&gt;
1     680    0.15</code></pre>
</div>
</div>
<p><code>summarize()</code> 혹은 <code>summarise()</code> 함수는 원하는 요약 통곗값을 계산합니다. PBR_max는 PBR 열에서 최댓값을, PBR_min은 최솟값을 계산해줍니다.</p>
</section>
<section id="arrange" class="level2">
<h2 class="anchored" data-anchor-id="arrange"><code>arrange()</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb382"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb382-1"><a href="#cb382-1" aria-hidden="true" tabindex="-1"></a>data_market <span class="sc">%&gt;%</span></span>
<span id="cb382-2"><a href="#cb382-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(PBR) <span class="sc">%&gt;%</span></span>
<span id="cb382-3"><a href="#cb382-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(PBR) <span class="sc">%&gt;%</span></span>
<span id="cb382-4"><a href="#cb382-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 1
    PBR
  &lt;dbl&gt;
1  0.15
2  0.19
3  0.2 
4  0.21
5  0.24</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb384"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb384-1"><a href="#cb384-1" aria-hidden="true" tabindex="-1"></a>data_market <span class="sc">%&gt;%</span></span>
<span id="cb384-2"><a href="#cb384-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ROE) <span class="sc">%&gt;%</span></span>
<span id="cb384-3"><a href="#cb384-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(ROE)) <span class="sc">%&gt;%</span></span>
<span id="cb384-4"><a href="#cb384-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 1
    ROE
  &lt;dbl&gt;
1 2.56 
2 2.48 
3 2.17 
4 1.02 
5 0.823</code></pre>
</div>
</div>
<p><code>arrange()</code> 함수는 선택한 열을 기준으로 데이터를 정렬해주며, 오름차순으로 정렬합니다. 내림차순으로 데이터를 정렬하려면 <code>arrange()</code> 내에 <code>desc()</code> 함수를 추가로 입력해주면 됩니다.</p>
</section>
<section id="row_number" class="level2">
<h2 class="anchored" data-anchor-id="row_number"><code>row_number()</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb386"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb386-1"><a href="#cb386-1" aria-hidden="true" tabindex="-1"></a>data_market <span class="sc">%&gt;%</span></span>
<span id="cb386-2"><a href="#cb386-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PBR_rank =</span> <span class="fu">row_number</span>(PBR)) <span class="sc">%&gt;%</span></span>
<span id="cb386-3"><a href="#cb386-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(종목명, PBR, PBR_rank) <span class="sc">%&gt;%</span></span>
<span id="cb386-4"><a href="#cb386-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(PBR) <span class="sc">%&gt;%</span></span>
<span id="cb386-5"><a href="#cb386-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  종목명           PBR PBR_rank
  &lt;chr&gt;          &lt;dbl&gt;    &lt;int&gt;
1 지스마트글로벌  0.15        1
2 세원정공        0.19        2
3 경동인베스트    0.2         3
4 한국전력        0.21        4
5 한화생명        0.24        5</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb388"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb388-1"><a href="#cb388-1" aria-hidden="true" tabindex="-1"></a>data_market <span class="sc">%&gt;%</span></span>
<span id="cb388-2"><a href="#cb388-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ROE_rank =</span> <span class="fu">row_number</span>(<span class="fu">desc</span>(ROE))) <span class="sc">%&gt;%</span></span>
<span id="cb388-3"><a href="#cb388-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(종목명, ROE, ROE_rank) <span class="sc">%&gt;%</span></span>
<span id="cb388-4"><a href="#cb388-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(ROE)) <span class="sc">%&gt;%</span></span>
<span id="cb388-5"><a href="#cb388-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  종목명             ROE ROE_rank
  &lt;chr&gt;            &lt;dbl&gt;    &lt;int&gt;
1 샘씨엔에스       2.56         1
2 이지바이오       2.48         2
3 솔브레인홀딩스   2.17         3
4 한컴라이프케어   1.02         4
5 에스디바이오센서 0.823        5</code></pre>
</div>
</div>
</section>
<section id="ntile" class="level2">
<h2 class="anchored" data-anchor-id="ntile"><code>ntile()</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb390"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb390-1"><a href="#cb390-1" aria-hidden="true" tabindex="-1"></a>data_market <span class="sc">%&gt;%</span></span>
<span id="cb390-2"><a href="#cb390-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PBR_tile =</span> <span class="fu">ntile</span>(PBR, <span class="at">n =</span> <span class="dv">5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb390-3"><a href="#cb390-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(PBR, PBR_tile) <span class="sc">%&gt;%</span></span>
<span id="cb390-4"><a href="#cb390-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
    PBR PBR_tile
  &lt;dbl&gt;    &lt;int&gt;
1  1.79        3
2  1.48        3
3  8.97        5
4 12.6         5
5  8.71        5
6  3.4         4</code></pre>
</div>
</div>
<p><code>ntile()</code> 함수는 분위수를 계산해주며, n 인자를 통해 몇 분위로 나눌지 선택할 수 있습니다. 해당 함수 역시 오름차순으로 분위수를 나눕니다.</p>
</section>
<section id="group_by" class="level2">
<h2 class="anchored" data-anchor-id="group_by"><code>group_by()</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb392"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb392-1"><a href="#cb392-1" aria-hidden="true" tabindex="-1"></a>data_market <span class="sc">%&gt;%</span></span>
<span id="cb392-2"><a href="#cb392-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">SEC_NM_KOR</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb392-3"><a href="#cb392-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 2
   SEC_NM_KOR         `n()`
   &lt;chr&gt;              &lt;int&gt;
 1 IT                   579
 2 건강관리             288
 3 경기관련소비재       342
 4 금융                  79
 5 산업재               349
 6 소재                 228
 7 에너지                28
 8 유틸리티              19
 9 커뮤니케이션서비스   116
10 필수소비재           103
11 &lt;NA&gt;                 106</code></pre>
</div>
</div>
<p><code>group_by()</code> 함수는 선택한 열 중 동일한 데이터를 기준으로 데이터를 묶어줍니다. 위 예제에서는 섹터를 나타내는 SEC_NM_KOR 기준으로 데이터를 묶었으며, <code>n()</code> 함수를 통해 해당 그룹 내 데이터의 개수를 구할 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb394"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb394-1"><a href="#cb394-1" aria-hidden="true" tabindex="-1"></a>data_market <span class="sc">%&gt;%</span></span>
<span id="cb394-2"><a href="#cb394-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">SEC_NM_KOR</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb394-3"><a href="#cb394-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">PBR_median =</span> <span class="fu">median</span>(PBR, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb394-4"><a href="#cb394-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(PBR_median)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 2
   SEC_NM_KOR         PBR_median
   &lt;chr&gt;                   &lt;dbl&gt;
 1 유틸리티                0.65 
 2 금융                    0.745
 3 필수소비재              1.05 
 4 산업재                  1.21 
 5 소재                    1.24 
 6 경기관련소비재          1.33 
 7 에너지                  1.46 
 8 IT                      2.07 
 9 &lt;NA&gt;                    2.15 
10 커뮤니케이션서비스      2.9  
11 건강관리                3.12 </code></pre>
</div>
</div>
<p>위 예제는 섹터를 기준으로 데이터를 묶은 후 <code>summarize()</code>를 통해 각 섹터에 속하는 종목의 PBR 중앙값을 구한 후 정렬했습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb396"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb396-1"><a href="#cb396-1" aria-hidden="true" tabindex="-1"></a>data_market <span class="sc">%&gt;%</span></span>
<span id="cb396-2"><a href="#cb396-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">시장구분</span><span class="st">`</span>, <span class="st">`</span><span class="at">SEC_NM_KOR</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb396-3"><a href="#cb396-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">PBR_median =</span> <span class="fu">median</span>(PBR, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb396-4"><a href="#cb396-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(PBR_median)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by '시장구분'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 22 × 3
# Groups:   시장구분 [2]
   시장구분 SEC_NM_KOR     PBR_median
   &lt;chr&gt;    &lt;chr&gt;               &lt;dbl&gt;
 1 KOSPI    금융                0.62 
 2 KOSPI    유틸리티            0.65 
 3 KOSPI    필수소비재          0.825
 4 KOSPI    에너지              0.87 
 5 KOSPI    경기관련소비재      1.02 
 6 KOSPI    산업재              1.02 
 7 KOSPI    소재                1.07 
 8 KOSDAQ   유틸리티            1.34 
 9 KOSDAQ   소재                1.42 
10 KOSDAQ   산업재              1.45 
# … with 12 more rows</code></pre>
</div>
</div>
<p>위 예제는 시장과 섹터를 기준으로 데이터를 그룹화한 후 각 그룹별 PBR 중앙값을 구했습니다. 이처럼 그룹은 하나만이 아닌 원하는 만큼 나눌 수 있습니다.</p>
</section>
<section id="geom_point" class="level2">
<h2 class="anchored" data-anchor-id="geom_point"><code>geom_point()</code></h2>
<p>이번에는 종목정보를 시각화하도록 하겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb399"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb399-1"><a href="#cb399-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb399-2"><a href="#cb399-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-3"><a href="#cb399-3" aria-hidden="true" tabindex="-1"></a>data_market <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ROE, <span class="at">y =</span> PBR)) <span class="sc">+</span></span>
<span id="cb399-4"><a href="#cb399-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="r_basic_files/figure-html/unnamed-chunk-206-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-43"><img src="r_basic_files/figure-html/unnamed-chunk-206-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<ol type="1">
<li><code>aes()</code> 인자 내부에 x축은 ROE 열을 사용하고, y축은 PBR 열을 사용하도록 정의합니다.</li>
<li><code>geom_point()</code> 함수를 통해 산점도 그래프를 그려줍니다. 원하는 그림이 그려지기는 했으나, ROE와 PBR에 극단치 데이터가 있어 둘 사이에 관계가 잘 보이지 않습니다.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb400"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb400-1"><a href="#cb400-1" aria-hidden="true" tabindex="-1"></a>data_market <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ROE, <span class="at">y =</span> PBR)) <span class="sc">+</span></span>
<span id="cb400-2"><a href="#cb400-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb400-3"><a href="#cb400-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.30</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 845 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="r_basic_files/figure-html/unnamed-chunk-207-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-44"><img src="r_basic_files/figure-html/unnamed-chunk-207-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>이번에는 극단치 효과를 제거하기 위해 <code>coord_cartesian()</code> 함수 내에 xlim과 ylim, 즉 x축과 y축의 범위를 직접 지정해줍니다. 극단치가 제거되어 데이터를 한눈에 확인할 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb402"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb402-1"><a href="#cb402-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_market, <span class="fu">aes</span>(<span class="at">x =</span> ROE, <span class="at">y =</span> PBR,</span>
<span id="cb402-2"><a href="#cb402-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color =</span> 시장구분,</span>
<span id="cb402-3"><a href="#cb402-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">shape =</span> 시장구분)) <span class="sc">+</span></span>
<span id="cb402-4"><a href="#cb402-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb402-5"><a href="#cb402-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>) <span class="sc">+</span></span>
<span id="cb402-6"><a href="#cb402-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.30</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="r_basic_files/figure-html/unnamed-chunk-208-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-45"><img src="r_basic_files/figure-html/unnamed-chunk-208-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<ol type="1">
<li><code>ggplot()</code> 함수 내부 aes 인자에 color와 shape를 지정해주면, 해당 그룹별로 모양과 색이 나타납니다. 코스피와 코스닥 종목들에 해당하는 데이터의 색과 점 모양을 다르게 표시할 수 있습니다.</li>
<li><code>geom_smooth()</code> 함수를 통해 평활선을 추가할 수도 있으며, 방법으로 lm(linear model)을 지정할 경우 선형회귀선을 그려주게 됩니다. 이 외에도 glm, gam, loess 등의 다양한 회귀선을 그려줄 수 있습니다.</li>
</ol>
</section>
<section id="geom_histogram" class="level2">
<h2 class="anchored" data-anchor-id="geom_histogram"><code>geom_histogram()</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb404"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb404-1"><a href="#cb404-1" aria-hidden="true" tabindex="-1"></a>data_market <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PBR)) <span class="sc">+</span></span>
<span id="cb404-2"><a href="#cb404-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb404-3"><a href="#cb404-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 24 rows containing non-finite values (`stat_bin()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="r_basic_files/figure-html/unnamed-chunk-209-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-46"><img src="r_basic_files/figure-html/unnamed-chunk-209-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p><code>geom_histogram()</code> 함수는 히스토그램을 나타내주며, binwidth 인자를 통해 막대의 너비를 선택해줄 수 있습니다. 국내 종목들의 PBR 데이터는 왼쪽에 쏠려 있고 오른쪽으로 꼬리가 긴 분포를 가지고 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb406"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb406-1"><a href="#cb406-1" aria-hidden="true" tabindex="-1"></a>data_market <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PBR)) <span class="sc">+</span></span>
<span id="cb406-2"><a href="#cb406-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..),</span>
<span id="cb406-3"><a href="#cb406-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">binwidth =</span> <span class="fl">0.1</span>,</span>
<span id="cb406-4"><a href="#cb406-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">'sky blue'</span>, <span class="at">fill =</span> <span class="st">'sky blue'</span>) <span class="sc">+</span> </span>
<span id="cb406-5"><a href="#cb406-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb406-6"><a href="#cb406-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">'red'</span>) <span class="sc">+</span></span>
<span id="cb406-7"><a href="#cb406-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">median</span>(PBR, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb406-8"><a href="#cb406-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">'blue'</span>) <span class="sc">+</span></span>
<span id="cb406-9"><a href="#cb406-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">median</span>(PBR, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb406-10"><a href="#cb406-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> <span class="fu">median</span>(PBR, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">y =</span> <span class="fl">0.05</span>),</span>
<span id="cb406-11"><a href="#cb406-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">col =</span> <span class="st">'black'</span>, <span class="at">size =</span> <span class="dv">6</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The dot-dot notation (`..density..`) was deprecated in ggplot2 3.4.0.
ℹ Please use `after_stat(density)` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 24 rows containing non-finite values (`stat_bin()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 24 rows containing non-finite values (`stat_density()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="r_basic_files/figure-html/unnamed-chunk-210-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-47"><img src="r_basic_files/figure-html/unnamed-chunk-210-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>PBR 히스토그램을 좀 더 자세하게 나타내보겠습니다.</p>
<ol type="1">
<li><code>geom_histogram()</code> 함수 내에 <code>aes(y = ..density..)</code>를 추가해 밀도함수로 바꿉니다.</li>
<li><code>geom_density()</code> 함수를 추가해 밀도곡선을 그려줍니다.</li>
<li><code>geom_vline()</code> 함수는 세로선을 그려주며, xintercept 즉 x축으로 PBR의 중앙값을 선택합니다.</li>
<li><code>geom_text()</code> 함수는 그림 내에 글자를 표현해주며, label 인자에 원하는 글자를 입력해준 후 글자가 표현될 x축, y축, 색상, 사이즈 등을 선택할 수 있습니다.</li>
</ol>
</section>
<section id="geom_boxplot" class="level2">
<h2 class="anchored" data-anchor-id="geom_boxplot"><code>geom_boxplot()</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb410"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb410-1"><a href="#cb410-1" aria-hidden="true" tabindex="-1"></a>data_market <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SEC_NM_KOR, <span class="at">y =</span> PBR)) <span class="sc">+</span></span>
<span id="cb410-2"><a href="#cb410-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb410-3"><a href="#cb410-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 24 rows containing non-finite values (`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="r_basic_files/figure-html/unnamed-chunk-211-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-48"><img src="r_basic_files/figure-html/unnamed-chunk-211-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>박스 플롯 역시 데이터의 분포와 이상치를 확인하기 좋은 그림이며, <code>geom_boxplot()</code> 함수를 통해 나타낼 수 있습니다.</p>
<ol type="1">
<li>x축 데이터로는 섹터 정보, y축 데이터로는 PBR을 선택합니다.</li>
<li><code>geom_boxplot()</code>을 통해 박스 플롯을 그려줍니다.</li>
<li><code>coord_flip()</code> 함수는 x축과 y축을 뒤집어 표현해주며 x축에 PBR, y축에 섹터 정보가 나타나게 됩니다.</li>
</ol>
<p>결과를 살펴보면 유틸리티나 금융 섹터는 PBR이 잘 모여 있는 반면, IT나 건강관리 섹터 등은 매우 극단적인 PBR을 가지고 있는 종목이 있습니다.</p>
</section>
<section id="dplyr과-ggplot을-연결하여-사용하기" class="level2">
<h2 class="anchored" data-anchor-id="dplyr과-ggplot을-연결하여-사용하기">dplyr과 ggplot을 연결하여 사용하기</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb412"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb412-1"><a href="#cb412-1" aria-hidden="true" tabindex="-1"></a>data_market <span class="sc">%&gt;%</span></span>
<span id="cb412-2"><a href="#cb412-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(SEC_NM_KOR)) <span class="sc">%&gt;%</span></span>
<span id="cb412-3"><a href="#cb412-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SEC_NM_KOR) <span class="sc">%&gt;%</span></span>
<span id="cb412-4"><a href="#cb412-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">ROE_sector =</span> <span class="fu">median</span>(ROE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb412-5"><a href="#cb412-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">PBR_sector =</span> <span class="fu">median</span>(PBR, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb412-6"><a href="#cb412-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ROE_sector, <span class="at">y =</span> PBR_sector,</span>
<span id="cb412-7"><a href="#cb412-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> SEC_NM_KOR, <span class="at">label =</span> SEC_NM_KOR)) <span class="sc">+</span></span>
<span id="cb412-8"><a href="#cb412-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb412-9"><a href="#cb412-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">color =</span> <span class="st">'black'</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">vjust =</span> <span class="fl">1.3</span>) <span class="sc">+</span></span>
<span id="cb412-10"><a href="#cb412-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'bottom'</span>,</span>
<span id="cb412-11"><a href="#cb412-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="r_basic_files/figure-html/unnamed-chunk-212-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-49"><img src="r_basic_files/figure-html/unnamed-chunk-212-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>앞에서 배운 데이터 분석과 시각화를 동시에 연결해 사용할 수도 있습니다.</p>
<ol type="1">
<li>데이터 분석의 단계로 <code>filter()</code>를 통해 섹터가 NA가 아닌 종목을 선택합니다.</li>
<li><code>group_by()</code>를 통해 섹터별 그룹을 묶습니다.</li>
<li><code>summarize()</code>를 통해 ROE와 PBR의 중앙값을 계산해줍니다.</li>
<li>x축과 y축을 설정한 후 색상과 라벨을 섹터로 지정해주면 각 섹터별로 색상이 다른 산점도가 그려집니다.</li>
<li><code>geom_text()</code> 함수를 통해 앞에서 라벨로 지정한 섹터 정보들을 출력해줍니다.</li>
<li><code>theme()</code> 함수를 통해 다양한 테마를 지정합니다. legend.position 인자로 범례를 하단에 배치했으며, legend.title 인자로 범례의 제목을 삭제했습니다.</li>
</ol>
</section>
<section id="geom_bar" class="level2">
<h2 class="anchored" data-anchor-id="geom_bar"><code>geom_bar()</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb413"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb413-1"><a href="#cb413-1" aria-hidden="true" tabindex="-1"></a>data_market <span class="sc">%&gt;%</span></span>
<span id="cb413-2"><a href="#cb413-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SEC_NM_KOR) <span class="sc">%&gt;%</span></span>
<span id="cb413-3"><a href="#cb413-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb413-4"><a href="#cb413-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SEC_NM_KOR, <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb413-5"><a href="#cb413-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">'identity'</span>) <span class="sc">+</span></span>
<span id="cb413-6"><a href="#cb413-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="r_basic_files/figure-html/unnamed-chunk-213-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-50"><img src="r_basic_files/figure-html/unnamed-chunk-213-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p><code>geom_bar()</code>는 막대 그래프를 그려주는 함수입니다.</p>
<ol type="1">
<li><code>group_by()</code>를 통해 섹터별 그룹을 묶어줍니다.</li>
<li><code>summarize()</code> 함수 내부에 <code>n()</code>을 통해 각 그룹별 데이터 개수를 구합니다.</li>
<li><code>ggplot()</code> 함수에서 x축에는 SEC_NM_KOR, y축에는 n을 지정해줍니다.</li>
<li><code>geom_bar()</code>를 통해 막대 그래프를 그려줍니다. y축에 해당하는 n 데이터를 그대로 사용하기 위해서는 stat 인자를 identity로 지정해주어야 합니다. <code>theme_*()</code> 함수를 통해 배경 테마를 바꿀 수도 있습니다.</li>
</ol>
<p>한편 위 그래프는 데이터 개수에 따라 순서대로 막대가 정렬되지 않아 보기에 좋은 형태는 아닙니다. 이를 반영해 더욱 보기 좋은 그래프로 나타내보겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb414"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb414-1"><a href="#cb414-1" aria-hidden="true" tabindex="-1"></a>data_market <span class="sc">%&gt;%</span></span>
<span id="cb414-2"><a href="#cb414-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(SEC_NM_KOR)) <span class="sc">%&gt;%</span></span>
<span id="cb414-3"><a href="#cb414-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SEC_NM_KOR) <span class="sc">%&gt;%</span></span>
<span id="cb414-4"><a href="#cb414-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb414-5"><a href="#cb414-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(SEC_NM_KOR, n), <span class="at">y =</span> n, <span class="at">label =</span> n)) <span class="sc">+</span></span>
<span id="cb414-6"><a href="#cb414-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">'identity'</span>) <span class="sc">+</span></span>
<span id="cb414-7"><a href="#cb414-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">color =</span> <span class="st">'black'</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb414-8"><a href="#cb414-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb414-9"><a href="#cb414-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb414-10"><a href="#cb414-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb414-11"><a href="#cb414-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.1</span>, <span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb414-12"><a href="#cb414-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="r_basic_files/figure-html/unnamed-chunk-214-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-51"><img src="r_basic_files/figure-html/unnamed-chunk-214-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<ol type="1">
<li><code>filter()</code> 함수를 통해 NA 종목은 삭제해준 후 섹터별 종목 개수를 구해줍니다.</li>
<li><code>ggplot()</code>의 x축에 <code>reorder()</code> 함수를 적용해 SEC_NM_KOR 변수를 n 순서대로 정렬해줍니다.</li>
<li><code>geom_bar()</code>를 통해 막대 그래프를 그려준 후 <code>geom_text()</code>를 통해 라벨에 해당하는 종목 개수를 출력합니다.</li>
<li><code>xlab()</code>과 <code>ylab()</code>에 NULL을 입력해 라벨을 삭제합니다.</li>
<li><code>coord_flip()</code> 함수를 통해 x축과 y축을 뒤집어줍니다.</li>
<li><code>scale_y_continuous()</code> 함수를 통해 그림의 간격을 약간 넓혀줍니다.</li>
<li><code>theme_classic()</code>으로 테마를 변경해줍니다.</li>
</ol>
<p>결과를 보면 종목수가 많은 섹터부터 순서대로 정렬되어 보기도 쉬우며, 종목수도 텍스트로 표현되어 한눈에 확인할 수 있습니다.</p>
<p>이처럼 데이터 시각화를 통해 정보의 분포나 특성을 한눈에 확인할 수 있으며, <code>ggplot()</code>을 이용하면 복잡한 형태의 그림도 매우 간단하고 아름답게 표현할 수 있습니다.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"descPosition":"bottom","selector":".lightbox","openEffect":"zoom","loop":true,"closeEffect":"zoom"});</script>



</body></html>